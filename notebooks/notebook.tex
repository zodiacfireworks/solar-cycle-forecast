
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{[NEW] Solar Cycle Forecast - McNish and Lincoln method}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
     

    \hypertarget{predicciuxf3n-del-ciclo-solar---el-algoritmo-mcnish-lincoln}{%
\section{Predicción del Ciclo Solar - El algoritmo
McNish-Lincoln}\label{predicciuxf3n-del-ciclo-solar---el-algoritmo-mcnish-lincoln}}

    \textbf{Martín Josemaría Vuelta Rojas}

    martin.vuelta@softbutterfly.io

    \emph{Universidad Nacional Mayor de San Marcos}

    Facultad de Ciencias Físicas

    \emph{SoftButterfly}

    Cofundador y CTO

    \hypertarget{ajustes-gruxe1ficos-e-importaciuxf3n-de-librerias-globales}{%
\subsection{Ajustes gráficos e importación de librerias
globales}\label{ajustes-gruxe1ficos-e-importaciuxf3n-de-librerias-globales}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{} Librerias que se utulizarán a lo largo de todo el notebook}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{uncertainties} \PY{k}{as} \PY{n+nn}{unc}
        \PY{k+kn}{import} \PY{n+nn}{uncertainties}\PY{n+nn}{.}\PY{n+nn}{unumpy} \PY{k}{as} \PY{n+nn}{unp}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{colors} \PY{k}{as} \PY{n+nn}{pltc}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} Ajustes generales para los gráficos}
        \PY{k+kn}{from} \PY{n+nn}{distutils}\PY{n+nn}{.}\PY{n+nn}{spawn} \PY{k}{import} \PY{n}{find\PYZus{}executable}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{font\PYZus{}manager} \PY{k}{import} \PY{n}{FontProperties}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn}
        \PY{k+kn}{import} \PY{n+nn}{gc}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{ioff}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{family}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{serif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{k}{if} \PY{n}{find\PYZus{}executable}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{latex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
            \PY{n}{plt}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{usetex}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Minor Third Type Scale}
        \PY{n}{scale\PYZus{}factor} \PY{o}{=} \PY{l+m+mf}{1.2}
        \PY{n}{base\PYZus{}font\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{12}
        
        \PY{n}{font\PYZus{}title} \PY{o}{=} \PY{n}{FontProperties}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{n}{base\PYZus{}font\PYZus{}size}\PY{o}{*}\PY{p}{(}\PY{n}{scale\PYZus{}factor}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
        \PY{n}{font\PYZus{}label} \PY{o}{=} \PY{n}{FontProperties}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{n}{base\PYZus{}font\PYZus{}size}\PY{o}{*}\PY{p}{(}\PY{n}{scale\PYZus{}factor}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
        \PY{n}{font\PYZus{}legend} \PY{o}{=} \PY{n}{FontProperties}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{n}{base\PYZus{}font\PYZus{}size}\PY{o}{*}\PY{p}{(}\PY{n}{scale\PYZus{}factor}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
        \PY{n}{font\PYZus{}ticks} \PY{o}{=} \PY{n}{FontProperties}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{n}{base\PYZus{}font\PYZus{}size}\PY{o}{*}\PY{p}{(}\PY{n}{scale\PYZus{}factor}\PY{o}{*}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
        
        \PY{n}{seaborn}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{context}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{notebook}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darkgrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \hypertarget{procesamiento-de-datos}{%
\subsection{Procesamiento de datos}\label{procesamiento-de-datos}}

    \hypertarget{descarga-de-datos}{%
\subsubsection{Descarga de datos}\label{descarga-de-datos}}

    Los datos de machas solares pueden obtenerse desde la página web de
\href{http://www.sidc.be/silso}{SILSO} (Sunspot Index and Long-term
Solar Observations).

\textbf{Enlaces útiles} 1. Directorio de datos:
http://sidc.oma.be/silso/datafiles 2. Especificacion de formato:
http://sidc.oma.be/silso/newdataset

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k+kn}{import} \PY{n+nn}{re}
        \PY{k+kn}{from} \PY{n+nn}{urllib} \PY{k}{import} \PY{n}{request}
        
        \PY{c+c1}{\PYZsh{} Set OFFLINE to False to get the mos recent data from SILSO}
        \PY{n}{OFFLINE} \PY{o}{=} \PY{k+kc}{True}
        
        \PY{c+c1}{\PYZsh{} Offline data is stored in the data directory}
        \PY{n}{OFFLINE\PYZus{}DATA\PYZus{}LOCATION} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./data/data.txt}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} Online data is obtained from SILSO}
        \PY{n}{ONLINE\PYZus{}DATA\PYZus{}LOCATION} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{http://www.sidc.be/silso/DATA/SN\PYZus{}d\PYZus{}tot\PYZus{}V2.0.txt}\PY{l+s+s2}{\PYZdq{}}
        
        
        \PY{k}{if} \PY{n}{OFFLINE}\PY{p}{:}
            \PY{n}{req} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{n}{OFFLINE\PYZus{}DATA\PYZus{}LOCATION}\PY{p}{)}
            \PY{n}{raw\PYZus{}text\PYZus{}data} \PY{o}{=} \PY{n}{req}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{else}\PY{p}{:}
            \PY{n}{req} \PY{o}{=} \PY{n}{request}\PY{o}{.}\PY{n}{urlopen}\PY{p}{(}\PY{n}{ONLINE\PYZus{}DATA\PYZus{}LOCATION}\PY{p}{)}
            \PY{n}{raw\PYZus{}text\PYZus{}data} \PY{o}{=} \PY{n}{req}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{decode}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{utf\PYZhy{}8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} Refresh offline data}
            \PY{n}{file\PYZus{}handler} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{n}{OFFLINE\PYZus{}DATA\PYZus{}LOCATION}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{file\PYZus{}handler}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{raw\PYZus{}text\PYZus{}data}\PY{p}{)}
            \PY{n}{file\PYZus{}handler}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \hypertarget{preprocesamiento-de-datos}{%
\subsubsection{Preprocesamiento de
datos}\label{preprocesamiento-de-datos}}

    Los datos obtenidos estan en formato de texto. Se tiene de convertir a
los tipos de datos correspondientes segun la especificacion de formato
dada \href{http://sidc.oma.be/silso/newdataset}{aquí}. Una vez
convertidos en el formato adecuado, los datos seran ordenados en un
dataset de Pandas.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{OrderedDict}
        
        \PY{c+c1}{\PYZsh{} Regex pattern to remove spurious multiple white space}
        \PY{n}{WHITE\PYZus{}SPACE} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ +}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Column headers according to SILSO, except the \PYZsq{}Date\PYZsq{} header which is an integrations of year, month and }
        \PY{c+c1}{\PYZsh{} day headers indicated by SILSO }
        \PY{n}{HEADERS} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decimal Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Observations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} Util functions}
        \PY{k}{def} \PY{n+nf}{isflag}\PY{p}{(}\PY{n}{ch}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Checks if the given character is a flag mark\PYZdq{}\PYZdq{}\PYZdq{}}
            \PY{k}{return} \PY{n}{ch} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}
        
        
        \PY{k}{def} \PY{n+nf}{fmt\PYZus{}pairing}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Match data with the correct format function\PYZdq{}\PYZdq{}\PYZdq{}}
            \PY{n}{formatters} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{,} \PY{n+nb}{float}\PY{p}{,} \PY{n+nb}{float}\PY{p}{,} \PY{n+nb}{float}\PY{p}{,} \PY{n+nb}{float}\PY{p}{,} \PY{n}{isflag}\PY{p}{]}
            \PY{n}{date} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
            \PY{n}{fractional\PYZus{}date} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}
            \PY{n}{sn\PYZus{}value} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}
            \PY{n}{sn\PYZus{}std} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]}
            \PY{n}{observers} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]}
            \PY{n}{flag\PYZus{}mark} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
            
            \PY{n}{values} \PY{o}{=} \PY{p}{[}\PY{n}{date}\PY{p}{,} \PY{n}{fractional\PYZus{}date}\PY{p}{,} \PY{n}{sn\PYZus{}value}\PY{p}{,} \PY{n}{sn\PYZus{}std}\PY{p}{,} \PY{n}{observers}\PY{p}{,} \PY{n}{flag\PYZus{}mark}\PY{p}{]}
            \PY{k}{return} \PY{n+nb}{list}\PY{p}{(}
                \PY{n+nb}{zip}\PY{p}{(}\PY{n}{formatters}\PY{p}{,} \PY{n}{values}\PY{p}{)}\PY{p}{)}
        
        
        \PY{k}{def} \PY{n+nf}{parse}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Parses data in x to the corrext python format\PYZdq{}\PYZdq{}\PYZdq{}}
            \PY{k}{return} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{y}\PY{p}{:} \PY{n}{y}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{(}\PY{n}{y}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{fmt\PYZus{}pairing}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        
        
        \PY{n}{raw\PYZus{}data} \PY{o}{=} \PY{n}{WHITE\PYZus{}SPACE}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{raw\PYZus{}text\PYZus{}data}\PY{p}{)}
        \PY{n}{raw\PYZus{}data} \PY{o}{=} \PY{n}{raw\PYZus{}data}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{raw\PYZus{}data} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{l}\PY{p}{:} \PY{n}{l}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{raw\PYZus{}data}\PY{p}{)}
        \PY{n}{raw\PYZus{}data} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{raw\PYZus{}data}\PY{p}{)}
        \PY{n}{raw\PYZus{}data} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n+nb}{map}\PY{p}{(}\PY{n}{parse}\PY{p}{,} \PY{n}{raw\PYZus{}data}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n}{raw\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{OrderedDict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{HEADERS}\PY{p}{,} \PY{n}{raw\PYZus{}data}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.0}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
        \PY{n}{raw\PYZus{}data} \PY{o}{=} \PY{n}{raw\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{raw\PYZus{}data}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}             Decimal Date  SN value  SN error  Observations   Flag
        Date                                                             
        1818-01-01      1818.001       NaN       NaN           0.0  False
        1818-01-02      1818.004       NaN       NaN           0.0  False
        1818-01-03      1818.007       NaN       NaN           0.0  False
        1818-01-04      1818.010       NaN       NaN           0.0  False
        1818-01-05      1818.012       NaN       NaN           0.0  False
        1818-01-06      1818.015       NaN       NaN           0.0  False
        1818-01-07      1818.018       NaN       NaN           0.0  False
        1818-01-08      1818.021      65.0      10.2           1.0  False
        1818-01-09      1818.023       NaN       NaN           0.0  False
        1818-01-10      1818.026       NaN       NaN           0.0  False
        1818-01-11      1818.029       NaN       NaN           0.0  False
        1818-01-12      1818.032       NaN       NaN           0.0  False
        1818-01-13      1818.034      37.0       7.7           1.0  False
        1818-01-14      1818.037       NaN       NaN           0.0  False
        1818-01-15      1818.040       NaN       NaN           0.0  False
        1818-01-16      1818.042       NaN       NaN           0.0  False
        1818-01-17      1818.045      77.0      11.1           1.0  False
        1818-01-18      1818.048      98.0      12.6           1.0  False
        1818-01-19      1818.051     105.0      13.0           1.0  False
        1818-01-20      1818.053       NaN       NaN           0.0  False
        1818-01-21      1818.056       NaN       NaN           0.0  False
        1818-01-22      1818.059       NaN       NaN           0.0  False
        1818-01-23      1818.062       NaN       NaN           0.0  False
        1818-01-24      1818.064       NaN       NaN           0.0  False
        1818-01-25      1818.067      25.0       6.3           1.0  False
        1818-01-26      1818.070       NaN       NaN           0.0  False
        1818-01-27      1818.073       NaN       NaN           0.0  False
        1818-01-28      1818.075      38.0       7.8           1.0  False
        1818-01-29      1818.078      20.0       5.7           1.0  False
        1818-01-30      1818.081       NaN       NaN           0.0  False
        {\ldots}                  {\ldots}       {\ldots}       {\ldots}           {\ldots}    {\ldots}
        2018-10-01      2018.749      17.0       1.3          28.0   True
        2018-10-02      2018.752      14.0       0.8          26.0   True
        2018-10-03      2018.755      12.0       0.7          34.0   True
        2018-10-04      2018.758      11.0       0.8          28.0   True
        2018-10-05      2018.760       0.0       0.0          49.0   True
        2018-10-06      2018.763       0.0       0.0          39.0   True
        2018-10-07      2018.766       0.0       0.0          38.0   True
        2018-10-08      2018.768       0.0       0.0          42.0   True
        2018-10-09      2018.771       0.0       0.0          47.0   True
        2018-10-10      2018.774       0.0       0.0          45.0   True
        2018-10-11      2018.777       5.0       0.4          15.0   True
        2018-10-12      2018.779      13.0       0.9          10.0   True
        2018-10-13      2018.782      26.0       2.5          13.0   True
        2018-10-14      2018.785      23.0       1.6          30.0   True
        2018-10-15      2018.788      17.0       6.2          28.0   True
        2018-10-16      2018.790       0.0       0.0          43.0   True
        2018-10-17      2018.793      11.0       0.9          27.0   True
        2018-10-18      2018.796       0.0       0.0          39.0   True
        2018-10-19      2018.799       0.0       0.0          39.0   True
        2018-10-20      2018.801       0.0       0.0          39.0   True
        2018-10-21      2018.804       3.0       1.0          12.0   True
        2018-10-22      2018.807       0.0       0.0          46.0   True
        2018-10-23      2018.810       0.0       0.0          29.0   True
        2018-10-24      2018.812       0.0       0.0          35.0   True
        2018-10-25      2018.815       0.0       0.0          28.0   True
        2018-10-26      2018.818       0.0       0.0          21.0   True
        2018-10-27      2018.821       0.0       0.0          27.0   True
        2018-10-28      2018.823       0.0       0.0          29.0   True
        2018-10-29      2018.826       0.0       0.0          21.0   True
        2018-10-30      2018.829       0.0       0.0          27.0   True
        
        [73352 rows x 5 columns]
\end{Verbatim}
            
    \hypertarget{algundas-cifras}{%
\paragraph{Algundas cifras}\label{algundas-cifras}}

    Obtenemos tres cantidades: * El total de registros * La cantidad de
registros en los cuales no se registraron obserrvaciones, es decir, se
tiene que el valor de `SN value' es NaN o, de forma equivalente,
`Observations' es 0. * El total de dias que no se observaron manchas en
el disco solar, es decir, que el valor de `SN value' fue igual a 0.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{} Basic Stats}
        \PY{c+c1}{\PYZsh{} Missing data (SN values = nan or Observations = 0)}
        \PY{n}{missing\PYZus{}data} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{raw\PYZus{}data}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{raw\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Observations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Days without sunspots (SN values = 0)}
        \PY{n}{no\PYZus{}sunspot\PYZus{}days} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{raw\PYZus{}data}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{raw\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total de registros    : }\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{len(raw\PYZus{}data)\PYZcb{} }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Días sin observaciones: }\PY{l+s+si}{\PYZob{}missing\PYZus{}data\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Días sin manchas      : }\PY{l+s+si}{\PYZob{}no\PYZus{}sunspot\PYZus{}days\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Total de registros    : 73352 
Días sin observaciones: 3247
Días sin manchas      : 10841

    \end{Verbatim}

    \hypertarget{registros-diarios}{%
\subsubsection{Registros diarios}\label{registros-diarios}}

    Los datos que nos interesan del dataset anterior son ``SN value'' y ``SN
error'' po lo cual seran separados en un dataset aparte.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{sn\PYZus{}daily} \PY{o}{=} \PY{n}{raw\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decimal Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Observations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{unp}\PY{o}{.}\PY{n}{uarray}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}
        \PY{n}{sn\PYZus{}daily}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:}                     SN  SN value  SN error
        Date                                      
        1818-01-01   nan+/-nan       NaN       NaN
        1818-01-02   nan+/-nan       NaN       NaN
        1818-01-03   nan+/-nan       NaN       NaN
        1818-01-04   nan+/-nan       NaN       NaN
        1818-01-05   nan+/-nan       NaN       NaN
        1818-01-06   nan+/-nan       NaN       NaN
        1818-01-07   nan+/-nan       NaN       NaN
        1818-01-08     65+/-10      65.0      10.2
        1818-01-09   nan+/-nan       NaN       NaN
        1818-01-10   nan+/-nan       NaN       NaN
        1818-01-11   nan+/-nan       NaN       NaN
        1818-01-12   nan+/-nan       NaN       NaN
        1818-01-13      37+/-8      37.0       7.7
        1818-01-14   nan+/-nan       NaN       NaN
        1818-01-15   nan+/-nan       NaN       NaN
        1818-01-16   nan+/-nan       NaN       NaN
        1818-01-17     77+/-11      77.0      11.1
        1818-01-18     98+/-13      98.0      12.6
        1818-01-19    105+/-13     105.0      13.0
        1818-01-20   nan+/-nan       NaN       NaN
        1818-01-21   nan+/-nan       NaN       NaN
        1818-01-22   nan+/-nan       NaN       NaN
        1818-01-23   nan+/-nan       NaN       NaN
        1818-01-24   nan+/-nan       NaN       NaN
        1818-01-25      25+/-6      25.0       6.3
        1818-01-26   nan+/-nan       NaN       NaN
        1818-01-27   nan+/-nan       NaN       NaN
        1818-01-28      38+/-8      38.0       7.8
        1818-01-29      20+/-6      20.0       5.7
        1818-01-30   nan+/-nan       NaN       NaN
        {\ldots}                {\ldots}       {\ldots}       {\ldots}
        2018-10-01  17.0+/-1.3      17.0       1.3
        2018-10-02  14.0+/-0.8      14.0       0.8
        2018-10-03  12.0+/-0.7      12.0       0.7
        2018-10-04  11.0+/-0.8      11.0       0.8
        2018-10-05     0.0+/-0       0.0       0.0
        2018-10-06     0.0+/-0       0.0       0.0
        2018-10-07     0.0+/-0       0.0       0.0
        2018-10-08     0.0+/-0       0.0       0.0
        2018-10-09     0.0+/-0       0.0       0.0
        2018-10-10     0.0+/-0       0.0       0.0
        2018-10-11   5.0+/-0.4       5.0       0.4
        2018-10-12  13.0+/-0.9      13.0       0.9
        2018-10-13  26.0+/-2.5      26.0       2.5
        2018-10-14  23.0+/-1.6      23.0       1.6
        2018-10-15      17+/-6      17.0       6.2
        2018-10-16     0.0+/-0       0.0       0.0
        2018-10-17  11.0+/-0.9      11.0       0.9
        2018-10-18     0.0+/-0       0.0       0.0
        2018-10-19     0.0+/-0       0.0       0.0
        2018-10-20     0.0+/-0       0.0       0.0
        2018-10-21   3.0+/-1.0       3.0       1.0
        2018-10-22     0.0+/-0       0.0       0.0
        2018-10-23     0.0+/-0       0.0       0.0
        2018-10-24     0.0+/-0       0.0       0.0
        2018-10-25     0.0+/-0       0.0       0.0
        2018-10-26     0.0+/-0       0.0       0.0
        2018-10-27     0.0+/-0       0.0       0.0
        2018-10-28     0.0+/-0       0.0       0.0
        2018-10-29     0.0+/-0       0.0       0.0
        2018-10-30     0.0+/-0       0.0       0.0
        
        [73352 rows x 3 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{} Sample plot for daily records}
        \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{} Sample plot for daily records error}
        \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{gruxe1fico-de-registros-diarios}{%
\paragraph{Gráfico de registros
diarios}\label{gruxe1fico-de-registros-diarios}}

    Realizaremos un grafico más detallado de los datos dividiéndolos en el
punto en que se registra el último día con datos perdidos (Sin
observaciones).

Los gráficos diarios se realizan en periodos de 50 años empezando desde
1818, el primer año de los registros obtenidos desde
\href{http://www.sidc.be/silso}{SILSO}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{60}
         \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{n}{periods} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{8.5}\PY{p}{,} \PY{n}{periods} \PY{o}{*} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{title} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Registro}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ diario}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ del}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ N}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{acute}\PY{l+s+si}{\PYZob{}u\PYZcb{}}\PY{l+s+s2}{mero}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Manchas}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Solares\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{100.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{last\PYZus{}nan\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{=} \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}index}\PY{p}{]}
         
         \PY{n}{first\PYZus{}axs} \PY{o}{=} \PY{k+kc}{None}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{periods}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{n}{periods}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
             
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{n}{first\PYZus{}axs} \PY{o}{=} \PY{n}{axs}
                 
             \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{)}
         
             \PY{n}{data} \PY{o}{=} \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{:}\PY{n}{x\PYZus{}limu}\PY{p}{]}
         
             \PY{k}{if} \PY{n}{x\PYZus{}limu} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{elif} \PY{n}{x\PYZus{}liml} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o+ow}{and} \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{x\PYZus{}limu}\PY{p}{:}
                 \PY{n}{graph1}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
                 \PY{n}{graph2}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
             \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{YEAR\PYZus{}DELTA} \PY{o}{/} \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA}\PY{p}{)}
             \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{x\PYZus{}liml} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{n\PYZus{}xticks}\PY{p}{)}
             \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
             \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Fecha\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mf}{1.30}\PY{p}{]}\PY{p}{)}  
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{p}{(}\PY{n}{graph1}\PY{p}{,} \PY{n}{graph2}\PY{p}{)}\PY{p}{,}
             \PY{p}{(}
                 \PY{p}{(}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{A}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tilde}\PY{l+s+si}{\PYZob{}n\PYZcb{}}\PY{l+s+s2}{os}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ con}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{registros}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ incompletos}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}(}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+si}{\PYZob{}1:\PYZcb{}}\PY{l+s+s2}{)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                         \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{,}
                         \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{p}{:}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)}
                 \PY{p}{)}\PY{p}{,}
                 \PY{p}{(}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{A}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tilde}\PY{l+s+si}{\PYZob{}n\PYZcb{}}\PY{l+s+s2}{os}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ con}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{registros}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ completos}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}(}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+si}{\PYZob{}1:\PYZcb{}}\PY{l+s+s2}{)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                         \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{,}
                         \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)}
                 \PY{p}{)}
             \PY{p}{)}\PY{p}{,}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.25}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{promedios-mensuales}{%
\subsubsection{Promedios mensuales}\label{promedios-mensuales}}

    Los datos diarios, como serie de tiempo, contienen una gran cantidad de
ruido y varios periodos de datos perdidos. Para poder trabajarlos de
mejor forma reducimos el ruido tomando el promedio mensual.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{def} \PY{n+nf}{umean}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{n}{test} \PY{o}{=} \PY{p}{[}\PY{n}{measure}\PY{o}{.}\PY{n}{nominal\PYZus{}value} \PY{k}{for} \PY{n}{measure} \PY{o+ow}{in} \PY{n}{x}\PY{p}{]}
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{k}{return} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
             
             \PY{k}{if} \PY{n+nb}{any}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{nanmean}\PY{p}{(}\PY{n}{x}\PY{p}{)}
             
             \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{} The trick to calculate the resultin amount of data is count all}
         \PY{c+c1}{\PYZsh{} the first day of each month in every year}
         \PY{n}{ndata} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{day} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{years} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{year}\PY{p}{)}
         \PY{n}{months} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month}\PY{p}{)}
         
         \PY{n}{sn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{[}\PY{n}{ndata}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{index} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{k}{for} \PY{n}{year} \PY{o+ow}{in} \PY{n}{years}\PY{p}{:}
             \PY{n}{year\PYZus{}group} \PY{o}{=} \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{year} \PY{o}{==} \PY{n}{year}\PY{p}{]}
             \PY{k}{for} \PY{n}{month} \PY{o+ow}{in} \PY{n}{months}\PY{p}{:}
                 \PY{n}{month\PYZus{}group} \PY{o}{=} \PY{n}{year\PYZus{}group}\PY{p}{[}\PY{n}{year\PYZus{}group}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month} \PY{o}{==} \PY{n}{month}\PY{p}{]}
                 
                 \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{month\PYZus{}group}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                     \PY{k}{break}
         
                 \PY{n}{sn\PYZus{}mean} \PY{o}{=} \PY{n}{umean}\PY{p}{(}\PY{n}{month\PYZus{}group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
                 \PY{n}{sn}\PY{p}{[}\PY{n}{index}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}year\PYZcb{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+si}{\PYZob{}month\PYZcb{}}\PY{l+s+s1}{\PYZhy{}01}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{sn\PYZus{}mean}\PY{p}{,} \PY{n}{sn\PYZus{}mean}\PY{o}{.}\PY{n}{nominal\PYZus{}value}\PY{p}{,} \PY{n}{sn\PYZus{}mean}\PY{o}{.}\PY{n}{std\PYZus{}dev}\PY{p}{]}
                 \PY{n}{index} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
             \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{month\PYZus{}group}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{k}{break}
         
         \PY{n}{sn} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n}{sn}\PY{p}{)}\PY{p}{)}
         \PY{n}{sn} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sn}\PY{p}{)}\PY{p}{)}
         \PY{n}{sn\PYZus{}monthly} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{sn}\PY{p}{)}
         \PY{n}{sn\PYZus{}monthly} \PY{o}{=} \PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{sn\PYZus{}monthly}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:}                       SN   SN value  SN error
         Date                                         
         1818-01-01    58.1+/-3.4  58.125000  3.417144
         1818-02-01    37.4+/-2.1  37.428571  2.094940
         1818-03-01    42.4+/-2.2  42.357143  2.210284
         1818-04-01    57.5+/-2.1  57.523810  2.093565
         1818-05-01    88.5+/-2.4  88.480000  2.383312
         1818-06-01    60.8+/-2.0  60.800000  1.975903
         1818-07-01    46.8+/-1.9  46.761905  1.888844
         1818-08-01    52.5+/-2.1  52.550000  2.053168
         1818-09-01    43.4+/-2.0  43.388889  1.966345
         1818-10-01    52.8+/-2.0  52.772727  1.961910
         1818-11-01    18.3+/-1.6  18.333333  1.587954
         1818-12-01    43.0+/-2.3  43.000000  2.321523
         1819-01-01    54.7+/-2.7  54.666667  2.708128
         1819-02-01    34.6+/-2.4  34.600000  2.366960
         1819-03-01     6.3+/-0.7   6.260870  0.746308
         1819-04-01    33.7+/-1.5  33.739130  1.549986
         1819-05-01    32.6+/-1.3  32.612903  1.317607
         1819-06-01    58.3+/-2.0  58.260870  2.015887
         1819-07-01    52.5+/-2.4  52.466667  2.362927
         1819-08-01    43.5+/-1.7  43.458333  1.714101
         1819-09-01    24.8+/-1.2  24.814815  1.233606
         1819-10-01    45.9+/-1.8  45.909091  1.832247
         1819-11-01    41.8+/-1.9  41.789474  1.900751
         1819-12-01    50.9+/-2.0  50.900000  2.024407
         1820-01-01    32.0+/-1.7  32.000000  1.666319
         1820-02-01    44.4+/-2.3  44.357143  2.254497
         1820-03-01     7.5+/-0.8   7.478261  0.813810
         1820-04-01    32.3+/-1.7  32.263158  1.669699
         1820-05-01    48.9+/-2.0  48.900000  1.978655
         1820-06-01    17.9+/-1.1  17.920000  1.111777
         {\ldots}                  {\ldots}        {\ldots}       {\ldots}
         2016-05-01    51.5+/-0.8  51.516129  0.783937
         2016-06-01    20.5+/-0.4  20.533333  0.414970
         2016-07-01    32.4+/-0.7  32.354839  0.724134
         2016-08-01    50.2+/-0.8  50.161290  0.793424
         2016-09-01    44.6+/-0.7  44.633333  0.658373
         2016-10-01    33.4+/-0.5  33.419355  0.534326
         2016-11-01    21.4+/-0.5  21.400000  0.462937
         2016-12-01    18.5+/-0.4  18.483871  0.442018
         2017-01-01    26.1+/-0.5  26.064516  0.451958
         2017-02-01    26.4+/-0.7  26.428571  0.671704
         2017-03-01    17.7+/-0.4  17.677419  0.449071
         2017-04-01    32.3+/-0.6  32.300000  0.608112
         2017-05-01    18.9+/-0.4  18.935484  0.364388
         2017-06-01  19.23+/-0.27  19.233333  0.273150
         2017-07-01    17.8+/-0.5  17.806452  0.489994
         2017-08-01    32.6+/-0.5  32.580645  0.516230
         2017-09-01    43.7+/-0.8  43.700000  0.768389
         2017-10-01  13.19+/-0.23  13.193548  0.228281
         2017-11-01   5.70+/-0.11   5.700000  0.112694
         2017-12-01   8.16+/-0.27   8.161290  0.271677
         2018-01-01   6.81+/-0.31   6.806452  0.312437
         2018-02-01  10.68+/-0.21  10.678571  0.210745
         2018-03-01   2.45+/-0.10   2.451613  0.098480
         2018-04-01   8.93+/-0.27   8.933333  0.271886
         2018-05-01  13.13+/-0.31  13.129032  0.312687
         2018-06-01  15.57+/-0.32  15.566667  0.321455
         2018-07-01   1.61+/-0.20   1.612903  0.200026
         2018-08-01   8.77+/-0.16   8.774194  0.157702
         2018-09-01   3.30+/-0.11   3.300000  0.112151
         2018-10-01   5.07+/-0.24   5.066667  0.243790
         
         [2410 rows x 3 columns]
\end{Verbatim}
            
    \hypertarget{explorando-data-perdida-en-los-promedios-mensuales}{%
\paragraph{Explorando data perdida en los promedios
mensuales}\label{explorando-data-perdida-en-los-promedios-mensuales}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:}                    SN  SN value  SN error
         Date                                     
         1824-02-01  nan+/-nan       NaN       NaN
\end{Verbatim}
            
    Hay un solo mes que tiene como promedio \emph{NaN}, esto se debe a que
en dicho mes no hubo ninguna observación registrada, como comprobaremos
a continuación con los datos diarios.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{} Obtenemos la fecha en la cual no se registraron datos}
         \PY{n}{missing\PYZus{}data\PYZus{}date} \PY{o}{=} \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{index}
         
         \PY{c+c1}{\PYZsh{} Obtenemos todos los datos con el mismo año que la fecha obtenida en missing\PYZus{}data\PYZus{}date}
         \PY{n}{missing\PYZus{}data} \PY{o}{=} \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{year} \PY{o}{==} \PY{n}{np}\PY{o}{.}\PY{n}{full}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{p}{)}\PY{p}{,} \PY{n}{missing\PYZus{}data\PYZus{}date}\PY{o}{.}\PY{n}{year}\PY{p}{)}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Con los resultados obtenidos obtenemos todos aquellos que corresponden al mes en missing\PYZus{}data\PYZus{}date}
         \PY{n}{missing\PYZus{}data} \PY{o}{=} \PY{n}{missing\PYZus{}data}\PY{p}{[}\PY{n}{missing\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{month} \PY{o}{==} \PY{n}{np}\PY{o}{.}\PY{n}{full}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{missing\PYZus{}data}\PY{p}{)}\PY{p}{,} \PY{n}{missing\PYZus{}data\PYZus{}date}\PY{o}{.}\PY{n}{month}\PY{p}{)}\PY{p}{]}
         \PY{n}{missing\PYZus{}data}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:}                    SN  SN value  SN error
         Date                                     
         1824-02-01  nan+/-nan       NaN       NaN
         1824-02-02  nan+/-nan       NaN       NaN
         1824-02-03  nan+/-nan       NaN       NaN
         1824-02-04  nan+/-nan       NaN       NaN
         1824-02-05  nan+/-nan       NaN       NaN
         1824-02-06  nan+/-nan       NaN       NaN
         1824-02-07  nan+/-nan       NaN       NaN
         1824-02-08  nan+/-nan       NaN       NaN
         1824-02-09  nan+/-nan       NaN       NaN
         1824-02-10  nan+/-nan       NaN       NaN
         1824-02-11  nan+/-nan       NaN       NaN
         1824-02-12  nan+/-nan       NaN       NaN
         1824-02-13  nan+/-nan       NaN       NaN
         1824-02-14  nan+/-nan       NaN       NaN
         1824-02-15  nan+/-nan       NaN       NaN
         1824-02-16  nan+/-nan       NaN       NaN
         1824-02-17  nan+/-nan       NaN       NaN
         1824-02-18  nan+/-nan       NaN       NaN
         1824-02-19  nan+/-nan       NaN       NaN
         1824-02-20  nan+/-nan       NaN       NaN
         1824-02-21  nan+/-nan       NaN       NaN
         1824-02-22  nan+/-nan       NaN       NaN
         1824-02-23  nan+/-nan       NaN       NaN
         1824-02-24  nan+/-nan       NaN       NaN
         1824-02-25  nan+/-nan       NaN       NaN
         1824-02-26  nan+/-nan       NaN       NaN
         1824-02-27  nan+/-nan       NaN       NaN
         1824-02-28  nan+/-nan       NaN       NaN
         1824-02-29  nan+/-nan       NaN       NaN
\end{Verbatim}
            
    \hypertarget{gruxe1fico-de-promedios-mensuales}{%
\paragraph{Gráfico de promedios
mensuales}\label{gruxe1fico-de-promedios-mensuales}}

    \hypertarget{promedios-mensuales}{%
\subparagraph{\texorpdfstring{\textbf{Promedios
mensuales}}{Promedios mensuales}}\label{promedios-mensuales}}

    De igual forma que se realizo el grafico de registros diarios, se
muestra el gráfico de los promedios mensuales

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{60}
         \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{n}{periods} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{8.5}\PY{p}{,} \PY{n}{periods} \PY{o}{*} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{title} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Promedio}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mensual}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ del}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ N}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{acute}\PY{l+s+si}{\PYZob{}u\PYZcb{}}\PY{l+s+s2}{mero}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Manchas}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Solares\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{100.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{last\PYZus{}nan\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}
         \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{=} \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}index}\PY{p}{]}
         \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{=} \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{first\PYZus{}axs} \PY{o}{=} \PY{k+kc}{None}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{periods}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{n}{periods}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
             
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{n}{first\PYZus{}axs} \PY{o}{=} \PY{n}{axs}
                 
             \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{)}
         
             \PY{n}{data} \PY{o}{=} \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{:}\PY{n}{x\PYZus{}limu}\PY{p}{]}
         
             \PY{k}{if} \PY{n}{x\PYZus{}limu} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{elif} \PY{n}{x\PYZus{}liml} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o+ow}{and} \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{x\PYZus{}limu}\PY{p}{:}
                 \PY{n}{graph1}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
                 \PY{n}{graph2}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
             \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{YEAR\PYZus{}DELTA} \PY{o}{/} \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA}\PY{p}{)}
             \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{x\PYZus{}liml} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{n\PYZus{}xticks}\PY{p}{)}
             \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
             \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Fecha\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mf}{1.30}\PY{p}{]}\PY{p}{)}  
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{p}{(}\PY{n}{graph1}\PY{p}{,} \PY{n}{graph2}\PY{p}{)}\PY{p}{,}
             \PY{p}{(}
                 \PY{p}{(}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{A}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tilde}\PY{l+s+si}{\PYZob{}n\PYZcb{}}\PY{l+s+s2}{os}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ con}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{registros}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ incompletos}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}(}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+si}{\PYZob{}1:\PYZcb{}}\PY{l+s+s2}{)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                         \PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{,}
                         \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{p}{:}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)}
                 \PY{p}{)}\PY{p}{,}
                 \PY{p}{(}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{A}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tilde}\PY{l+s+si}{\PYZob{}n\PYZcb{}}\PY{l+s+s2}{os}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ con}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{registros}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ completos}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}(}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+si}{\PYZob{}1:\PYZcb{}}\PY{l+s+s2}{)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                         \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{,}
                         \PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)}
                 \PY{p}{)}
             \PY{p}{)}\PY{p}{,}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.25}\PY{p}{)}\PY{p}{,}
             \PY{c+c1}{\PYZsh{} bbox\PYZus{}to\PYZus{}anchor=(0.5, 1\PYZhy{}SPACING\PYZus{}ADJUST),}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{superposiciuxf3n-del-promedio-mensual-sobre-el-registro-diario}{%
\subparagraph{\texorpdfstring{\textbf{Superposición del promedio mensual
sobre el registro
diario}}{Superposición del promedio mensual sobre el registro diario}}\label{superposiciuxf3n-del-promedio-mensual-sobre-el-registro-diario}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{60}
         \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{10}
         \PY{n}{SPACING\PYZus{}ADJUST} \PY{o}{=} \PY{l+m+mf}{0.025}
         
         \PY{n}{periods} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{8.5}\PY{p}{,} \PY{n}{periods} \PY{o}{*} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{title} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Registro}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ diario}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ del}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ N}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{acute}\PY{l+s+si}{\PYZob{}u\PYZcb{}}\PY{l+s+s2}{mero}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Manchas}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Solares\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{100.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{periods}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{n}{periods}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}    
                 
             \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{)}
             
             \PY{n}{data} \PY{o}{=} \PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{:}\PY{n}{x\PYZus{}limu}\PY{p}{]}
         
             \PY{n}{graph1}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                 \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}03a9f4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                 \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             
             \PY{n}{data} \PY{o}{=} \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{:}\PY{n}{x\PYZus{}limu}\PY{p}{]}
         
             \PY{n}{graph2}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                 \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,}
                 \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mf}{1.30}\PY{p}{]}\PY{p}{)}  
                 \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
                     \PY{p}{(}\PY{n}{graph1}\PY{p}{,} \PY{n}{graph2}\PY{p}{)}\PY{p}{,}
                     \PY{p}{(}
                         \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Registro}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ diario\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                         \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Promedio}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mensual\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
                     \PY{p}{)}\PY{p}{,}
                     \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.25}\PY{p}{)}\PY{p}{,}
                     \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                     \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
                     \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
             \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{YEAR\PYZus{}DELTA} \PY{o}{/} \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA}\PY{p}{)}
             \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{x\PYZus{}liml} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{n\PYZus{}xticks}\PY{p}{)}
             \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
             \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} axs.grid(color=\PYZsq{}\PYZsh{}ffffff\PYZsq{}, linestyle=\PYZsq{}\PYZhy{}\PYZsq{})}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Fecha\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{media-movil-reducciuxf3n-de-ruido}{%
\subsubsection{Media movil: Reducción de
ruido}\label{media-movil-reducciuxf3n-de-ruido}}

    Aún el promedio mensual contiene una cantidad considerable de ruido: una
alta variabilidad en valores contiguos. Este ruido se puede reducir
aplicando una media movil. El ancho de la media movil según la
literatura es de \(13\) y con un pero unitario en los extremos y el
doble en los valores centrales. La formula para calcular esta media
movil es la siguiente

    \[
\tilde{\mathcal{R}}_n = \frac{1}{24}\sum_{i=-6}^{5}\mathcal{R}_{n+i} + \frac{1}{24}\sum_{i=-5}^{6}\mathcal{R}_{n+i}
\]

    Este filtro elimina buena parte del ruido y, aunque no es el mejor, es
el mas ampliamente usado.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{def} \PY{n+nf}{uwmean}\PY{p}{(}\PY{n}{w}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{w}\PY{p}{)} \PY{o}{!=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
                 \PY{k}{return} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
             
             \PY{n}{test} \PY{o}{=} \PY{p}{[}\PY{n}{measure}\PY{o}{.}\PY{n}{nominal\PYZus{}value} \PY{k}{for} \PY{n}{measure} \PY{o+ow}{in} \PY{n}{x}\PY{p}{]}
             
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{k}{return} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
             
             \PY{k}{if} \PY{n+nb}{any}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{nansum}\PY{p}{(}\PY{n}{w} \PY{o}{*} \PY{n}{x}\PY{p}{)}
         
             \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{w} \PY{o}{*} \PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{ndata} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{)}
         \PY{n}{sn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{[}\PY{n}{ndata}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{w} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{w} \PY{o}{=} \PY{n}{w}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{w}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{index} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{ndata}\PY{p}{)}\PY{p}{:}
             \PY{n}{ilower} \PY{o}{=} \PY{n}{index} \PY{o}{\PYZhy{}} \PY{l+m+mi}{6}
             \PY{n}{ilower} \PY{o}{=} \PY{n}{ilower} \PY{k}{if} \PY{n}{ilower} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}
         
             \PY{n}{iupper} \PY{o}{=} \PY{n}{index} \PY{o}{+} \PY{l+m+mi}{7}
             \PY{n}{iupper} \PY{o}{=} \PY{n}{iupper} \PY{k}{if} \PY{n}{iupper} \PY{o}{\PYZlt{}} \PY{n}{ndata} \PY{k}{else} \PY{n}{ndata}
         
             \PY{n}{group} \PY{o}{=} \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{ilower}\PY{p}{:}\PY{n}{iupper}\PY{p}{]}
         
             \PY{n}{sn\PYZus{}wmean} \PY{o}{=} \PY{n}{uwmean}\PY{p}{(}\PY{n}{w}\PY{p}{,} \PY{n}{group}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}
             \PY{n}{sn}\PY{p}{[}\PY{n}{index}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{sn\PYZus{}monthly}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{n}{sn\PYZus{}wmean}\PY{p}{,} \PY{n}{sn\PYZus{}wmean}\PY{o}{.}\PY{n}{nominal\PYZus{}value}\PY{p}{,} \PY{n}{sn\PYZus{}wmean}\PY{o}{.}\PY{n}{std\PYZus{}dev}\PY{p}{]}
         
         \PY{n}{sn} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n}{sn}\PY{p}{)}\PY{p}{)}
         \PY{n}{sn} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sn}\PY{p}{)}\PY{p}{)}
         \PY{n}{sn\PYZus{}smooth} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{sn}\PY{p}{)}
         \PY{n}{sn\PYZus{}smooth} \PY{o}{=} \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Date}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{sn\PYZus{}smooth}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:}                       SN   SN value  SN error
         Date                                         
         1818-01-01     nan+/-nan        NaN       NaN
         1818-02-01     nan+/-nan        NaN       NaN
         1818-03-01     nan+/-nan        NaN       NaN
         1818-04-01     nan+/-nan        NaN       NaN
         1818-05-01     nan+/-nan        NaN       NaN
         1818-06-01     nan+/-nan        NaN       NaN
         1818-07-01    50.0+/-0.6  49.982684  0.597472
         1818-08-01    49.7+/-0.6  49.720730  0.601471
         1818-09-01    48.1+/-0.6  48.098861  0.599040
         1818-10-01    45.6+/-0.6  45.603822  0.578456
         1818-11-01    42.3+/-0.6  42.284998  0.559415
         1818-12-01    39.9+/-0.5  39.851405  0.546668
         1819-01-01    40.0+/-0.6  39.983306  0.551675
         1819-02-01    39.8+/-0.6  39.842185  0.557115
         1819-03-01    38.7+/-0.5  38.689446  0.548512
         1819-04-01    37.6+/-0.5  37.629541  0.536525
         1819-05-01    38.3+/-0.5  38.320896  0.540186
         1819-06-01    39.6+/-0.5  39.627402  0.534121
         1819-07-01    39.0+/-0.5  39.012124  0.513708
         1819-08-01    38.5+/-0.5  38.474227  0.495247
         1819-09-01    38.9+/-0.5  38.931499  0.510161
         1819-10-01    38.9+/-0.5  38.920725  0.505049
         1819-11-01    39.5+/-0.5  39.537855  0.513009
         1819-12-01    38.5+/-0.5  38.535615  0.511406
         1820-01-01    36.1+/-0.5  36.091253  0.495550
         1820-02-01    35.3+/-0.5  35.313566  0.518473
         1820-03-01    34.6+/-0.5  34.625420  0.527317
         1820-04-01    32.7+/-0.5  32.658783  0.512947
         1820-05-01    30.2+/-0.5  30.176150  0.496869
         1820-06-01    27.5+/-0.5  27.492975  0.481121
         {\ldots}                  {\ldots}        {\ldots}       {\ldots}
         2016-05-01  44.81+/-0.21  44.812120  0.209788
         2016-06-01  41.47+/-0.20  41.465659  0.199216
         2016-07-01  38.53+/-0.19  38.530176  0.190648
         2016-08-01  35.99+/-0.18  35.994594  0.180856
         2016-09-01  33.23+/-0.17  33.230517  0.173308
         2016-10-01  31.48+/-0.17  31.481055  0.168932
         2016-11-01  29.89+/-0.16  29.890195  0.163904
         2016-12-01  28.48+/-0.16  28.478501  0.160380
         2017-01-01  27.82+/-0.15  27.818152  0.153288
         2017-02-01  26.48+/-0.14  26.479442  0.144987
         2017-03-01  25.71+/-0.14  25.708026  0.141717
         2017-04-01  24.83+/-0.14  24.826395  0.144948
         2017-05-01  23.33+/-0.14  23.329487  0.140326
         2017-06-01  22.25+/-0.14  22.245212  0.136000
         2017-07-01  21.01+/-0.13  21.012686  0.132841
         2017-08-01  19.55+/-0.12  19.554016  0.124611
         2017-09-01  18.26+/-0.12  18.263358  0.118077
         2017-10-01  16.66+/-0.11  16.655338  0.108835
         2017-11-01  15.44+/-0.11  15.439791  0.105196
         2017-12-01  15.05+/-0.11  15.045078  0.105526
         2018-01-01  14.22+/-0.10  14.217569  0.101800
         2018-02-01  12.55+/-0.09  12.550902  0.093862
         2018-03-01   9.88+/-0.07   9.875634  0.073646
         2018-04-01   7.85+/-0.07   7.853680  0.065543
         2018-05-01     nan+/-nan        NaN       NaN
         2018-06-01     nan+/-nan        NaN       NaN
         2018-07-01     nan+/-nan        NaN       NaN
         2018-08-01     nan+/-nan        NaN       NaN
         2018-09-01     nan+/-nan        NaN       NaN
         2018-10-01     nan+/-nan        NaN       NaN
         
         [2410 rows x 3 columns]
\end{Verbatim}
            
    \hypertarget{explorando-datos-perdidos-en-los-promedios-suavizados}{%
\paragraph{Explorando datos perdidos en los promedios
suavizados}\label{explorando-datos-perdidos-en-los-promedios-suavizados}}

    El filtro aplicado es solo valido para los datos centrales de la serie
de tiempo, perdiendo los \(6\) primeros y los \(6\) últimos valores de
la serie.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:} 12
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:}                    SN  SN value  SN error
         Date                                     
         1818-01-01  nan+/-nan       NaN       NaN
         1818-02-01  nan+/-nan       NaN       NaN
         1818-03-01  nan+/-nan       NaN       NaN
         1818-04-01  nan+/-nan       NaN       NaN
         1818-05-01  nan+/-nan       NaN       NaN
         1818-06-01  nan+/-nan       NaN       NaN
         2018-05-01  nan+/-nan       NaN       NaN
         2018-06-01  nan+/-nan       NaN       NaN
         2018-07-01  nan+/-nan       NaN       NaN
         2018-08-01  nan+/-nan       NaN       NaN
         2018-09-01  nan+/-nan       NaN       NaN
         2018-10-01  nan+/-nan       NaN       NaN
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{6}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:}                    SN  SN value  SN error
         Date                                     
         1818-01-01  nan+/-nan       NaN       NaN
         1818-02-01  nan+/-nan       NaN       NaN
         1818-03-01  nan+/-nan       NaN       NaN
         1818-04-01  nan+/-nan       NaN       NaN
         1818-05-01  nan+/-nan       NaN       NaN
         1818-06-01  nan+/-nan       NaN       NaN
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:}                    SN  SN value  SN error
         Date                                     
         2018-05-01  nan+/-nan       NaN       NaN
         2018-06-01  nan+/-nan       NaN       NaN
         2018-07-01  nan+/-nan       NaN       NaN
         2018-08-01  nan+/-nan       NaN       NaN
         2018-09-01  nan+/-nan       NaN       NaN
         2018-10-01  nan+/-nan       NaN       NaN
\end{Verbatim}
            
    Habiendo identificado que los valores \texttt{NaN} los eliminamos del
conjunto principal de datos.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{sn\PYZus{}smooth} \PY{o}{=} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{]}
         \PY{n}{sn\PYZus{}smooth}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:}                       SN   SN value  SN error
         Date                                         
         1818-07-01    50.0+/-0.6  49.982684  0.597472
         1818-08-01    49.7+/-0.6  49.720730  0.601471
         1818-09-01    48.1+/-0.6  48.098861  0.599040
         1818-10-01    45.6+/-0.6  45.603822  0.578456
         1818-11-01    42.3+/-0.6  42.284998  0.559415
         1818-12-01    39.9+/-0.5  39.851405  0.546668
         1819-01-01    40.0+/-0.6  39.983306  0.551675
         1819-02-01    39.8+/-0.6  39.842185  0.557115
         1819-03-01    38.7+/-0.5  38.689446  0.548512
         1819-04-01    37.6+/-0.5  37.629541  0.536525
         1819-05-01    38.3+/-0.5  38.320896  0.540186
         1819-06-01    39.6+/-0.5  39.627402  0.534121
         1819-07-01    39.0+/-0.5  39.012124  0.513708
         1819-08-01    38.5+/-0.5  38.474227  0.495247
         1819-09-01    38.9+/-0.5  38.931499  0.510161
         1819-10-01    38.9+/-0.5  38.920725  0.505049
         1819-11-01    39.5+/-0.5  39.537855  0.513009
         1819-12-01    38.5+/-0.5  38.535615  0.511406
         1820-01-01    36.1+/-0.5  36.091253  0.495550
         1820-02-01    35.3+/-0.5  35.313566  0.518473
         1820-03-01    34.6+/-0.5  34.625420  0.527317
         1820-04-01    32.7+/-0.5  32.658783  0.512947
         1820-05-01    30.2+/-0.5  30.176150  0.496869
         1820-06-01    27.5+/-0.5  27.492975  0.481121
         1820-07-01    26.2+/-0.5  26.166413  0.480958
         1820-08-01    24.8+/-0.5  24.776532  0.488813
         1820-09-01    23.3+/-0.5  23.304941  0.480506
         1820-10-01    22.7+/-0.5  22.679860  0.470070
         1820-11-01    20.0+/-0.5  20.049257  0.451560
         1820-12-01    17.5+/-0.4  17.505589  0.438749
         {\ldots}                  {\ldots}        {\ldots}       {\ldots}
         2015-11-01  61.22+/-0.26  61.218706  0.260015
         2015-12-01  57.75+/-0.25  57.749710  0.248866
         2016-01-01  54.44+/-0.24  54.440659  0.238682
         2016-02-01  52.45+/-0.24  52.451412  0.235113
         2016-03-01  50.44+/-0.23  50.443437  0.226990
         2016-04-01  47.77+/-0.22  47.770140  0.218433
         2016-05-01  44.81+/-0.21  44.812120  0.209788
         2016-06-01  41.47+/-0.20  41.465659  0.199216
         2016-07-01  38.53+/-0.19  38.530176  0.190648
         2016-08-01  35.99+/-0.18  35.994594  0.180856
         2016-09-01  33.23+/-0.17  33.230517  0.173308
         2016-10-01  31.48+/-0.17  31.481055  0.168932
         2016-11-01  29.89+/-0.16  29.890195  0.163904
         2016-12-01  28.48+/-0.16  28.478501  0.160380
         2017-01-01  27.82+/-0.15  27.818152  0.153288
         2017-02-01  26.48+/-0.14  26.479442  0.144987
         2017-03-01  25.71+/-0.14  25.708026  0.141717
         2017-04-01  24.83+/-0.14  24.826395  0.144948
         2017-05-01  23.33+/-0.14  23.329487  0.140326
         2017-06-01  22.25+/-0.14  22.245212  0.136000
         2017-07-01  21.01+/-0.13  21.012686  0.132841
         2017-08-01  19.55+/-0.12  19.554016  0.124611
         2017-09-01  18.26+/-0.12  18.263358  0.118077
         2017-10-01  16.66+/-0.11  16.655338  0.108835
         2017-11-01  15.44+/-0.11  15.439791  0.105196
         2017-12-01  15.05+/-0.11  15.045078  0.105526
         2018-01-01  14.22+/-0.10  14.217569  0.101800
         2018-02-01  12.55+/-0.09  12.550902  0.093862
         2018-03-01   9.88+/-0.07   9.875634  0.073646
         2018-04-01   7.85+/-0.07   7.853680  0.065543
         
         [2398 rows x 3 columns]
\end{Verbatim}
            
    \hypertarget{gruxe1fico-de-promedios-sauvizados}{%
\paragraph{Gráfico de promedios
sauvizados}\label{gruxe1fico-de-promedios-sauvizados}}

    \hypertarget{promedio-suavizados}{%
\subparagraph{\texorpdfstring{\textbf{Promedio
suavizados}}{Promedio suavizados}}\label{promedio-suavizados}}

    De igual forma que se realizo el grafico de promedios mensuales, se
muestra el gráfico de los promedios suavizados

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{k+kn}{from} \PY{n+nn}{pandas} \PY{k}{import} \PY{n}{Timedelta}
         
         \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{60}
         \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{n}{periods} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{8.5}\PY{p}{,} \PY{n}{periods} \PY{o}{*} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{title} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Promedio}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ suavizado}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ del}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ N}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{acute}\PY{l+s+si}{\PYZob{}u\PYZcb{}}\PY{l+s+s2}{mero}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Manchas}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Solares\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{100.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{offset} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{last\PYZus{}nan\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{sn\PYZus{}daily}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{offset}
         \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{=} \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}index}\PY{p}{]}
         \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{=} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{first\PYZus{}axs} \PY{o}{=} \PY{k+kc}{None}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{periods}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{n}{periods}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
             
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{n}{first\PYZus{}axs} \PY{o}{=} \PY{n}{axs}
                 
             \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{)}
         
             \PY{n}{data} \PY{o}{=} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{:}\PY{n}{x\PYZus{}limu}\PY{p}{]}
         
             \PY{k}{if} \PY{n}{x\PYZus{}limu} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{elif} \PY{n}{x\PYZus{}liml} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o+ow}{and} \PY{n}{last\PYZus{}nan\PYZus{}date} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{x\PYZus{}limu}\PY{p}{:}
                 \PY{n}{graph1}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{p}{:}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
                 \PY{n}{graph2}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                     \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
             \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{YEAR\PYZus{}DELTA} \PY{o}{/} \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA}\PY{p}{)}
             \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{x\PYZus{}liml} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{n\PYZus{}xticks}\PY{p}{)}
             \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
             \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Fecha\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mf}{1.30}\PY{p}{]}\PY{p}{)}  
         \PY{n}{first\PYZus{}axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{p}{(}\PY{n}{graph1}\PY{p}{,} \PY{n}{graph2}\PY{p}{)}\PY{p}{,}
             \PY{p}{(}
                 \PY{p}{(}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{A}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tilde}\PY{l+s+si}{\PYZob{}n\PYZcb{}}\PY{l+s+s2}{os}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ con}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{registros}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ incompletos}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}(}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+si}{\PYZob{}1:\PYZcb{}}\PY{l+s+s2}{)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                         \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{,}
                         \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{p}{:}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)}
                 \PY{p}{)}\PY{p}{,}
                 \PY{p}{(}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{A}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{tilde}\PY{l+s+si}{\PYZob{}n\PYZcb{}}\PY{l+s+s2}{os}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ con}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+}
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{registros}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ completos}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ \PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
                     \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}(}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+si}{\PYZob{}1:\PYZcb{}}\PY{l+s+s2}{)\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                         \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{last\PYZus{}nan\PYZus{}date}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{,}
                         \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)}
                 \PY{p}{)}
             \PY{p}{)}\PY{p}{,}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.25}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_61_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{superposiciuxf3n-del-promedio-sauvizado-sobre-el-promedio-mensual}{%
\subparagraph{\texorpdfstring{\textbf{Superposición del promedio
sauvizado sobre el promedio
mensual}}{Superposición del promedio sauvizado sobre el promedio mensual}}\label{superposiciuxf3n-del-promedio-sauvizado-sobre-el-promedio-mensual}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{k+kn}{from} \PY{n+nn}{pandas} \PY{k}{import} \PY{n}{Timedelta}
         
         \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{60}
         \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA} \PY{o}{=} \PY{l+m+mi}{10}
         \PY{n}{SPACING\PYZus{}ADJUST} \PY{o}{=} \PY{l+m+mf}{0.025}
         
         \PY{n}{periods} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{8.5}\PY{p}{,} \PY{n}{periods} \PY{o}{*} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{title} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{N}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{acute}\PY{l+s+si}{\PYZob{}u\PYZcb{}}\PY{l+s+s2}{mero}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Manchas}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Solares\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{100.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{periods}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{n}{periods}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}    
                 
             \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{p}{(}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{YEAR\PYZus{}DELTA} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{)}
             
             \PY{n}{data} \PY{o}{=} \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{:}\PY{n}{x\PYZus{}limu}\PY{p}{]}
         
             \PY{n}{graph1}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                 \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}03a9f4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                 \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             
             \PY{n}{data} \PY{o}{=} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{:}\PY{n}{x\PYZus{}limu}\PY{p}{]}
         
             \PY{n}{graph2}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                 \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,}
                 \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
                 
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{title}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
                 \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mf}{1.30}\PY{p}{]}\PY{p}{)}  
                 \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
                     \PY{p}{(}\PY{n}{graph1}\PY{p}{,} \PY{n}{graph2}\PY{p}{)}\PY{p}{,}
                     \PY{p}{(}
                         \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Promedio}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mensual\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                         \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Promedio}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ suavizado\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
                     \PY{p}{)}\PY{p}{,}
                     \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                     \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.25}\PY{p}{)}\PY{p}{,}
                     \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                     \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
                     \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
             \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{YEAR\PYZus{}DELTA} \PY{o}{/} \PY{n}{X\PYZus{}TICKS\PYZus{}DELTA}\PY{p}{)}
             \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{x\PYZus{}liml} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{n\PYZus{}xticks}\PY{p}{)}
             \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
             \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} axs.grid(color=\PYZsq{}\PYZsh{}ffffff\PYZsq{}, linestyle=\PYZsq{}\PYZhy{}\PYZsq{})}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Fecha\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_63_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{algoritmo-de-mcnish-lincoln}{%
\subsection{Algoritmo de
McNish-Lincoln}\label{algoritmo-de-mcnish-lincoln}}

    \hypertarget{detecciuxf3n-de-picos}{%
\subsubsection{Detección de picos}\label{detecciuxf3n-de-picos}}

    \hypertarget{algoritmo-de-detecciuxf3n}{%
\paragraph{Algoritmo de detección}\label{algoritmo-de-detecciuxf3n}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{k}{def} \PY{n+nf}{\PYZus{}datacheck\PYZus{}peakdetect}\PY{p}{(}\PY{n}{x\PYZus{}axis}\PY{p}{,} \PY{n}{y\PYZus{}axis}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{x\PYZus{}axis} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{x\PYZus{}axis} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{y\PYZus{}axis}\PY{p}{)}\PY{p}{)}
             
             \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{y\PYZus{}axis}\PY{p}{)} \PY{o}{!=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x\PYZus{}axis}\PY{p}{)}\PY{p}{:}
                 \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(} 
                         \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Input vectors y\PYZus{}axis and x\PYZus{}axis must have same length}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}needs to be a numpy array}
             \PY{n}{y\PYZus{}axis} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{y\PYZus{}axis}\PY{p}{)}
             \PY{n}{x\PYZus{}axis} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{x\PYZus{}axis}\PY{p}{)}
             
             \PY{k}{return} \PY{n}{x\PYZus{}axis}\PY{p}{,} \PY{n}{y\PYZus{}axis}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{k}{def} \PY{n+nf}{peakdetect}\PY{p}{(}\PY{n}{y\PYZus{}axis}\PY{p}{,} \PY{n}{x\PYZus{}axis} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{lookahead} \PY{o}{=} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{delta}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    Converted from/based on a MATLAB script at: }
         \PY{l+s+sd}{    http://billauer.co.il/peakdet.html}
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    function for detecting local maxima and minima in a signal.}
         \PY{l+s+sd}{    Discovers peaks by searching for values which are surrounded by lower}
         \PY{l+s+sd}{    or larger values for maxima and minima respectively}
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    keyword arguments:}
         \PY{l+s+sd}{    y\PYZus{}axis \PYZhy{}\PYZhy{} A list containing the signal over which to find peaks}
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    x\PYZus{}axis \PYZhy{}\PYZhy{} A x\PYZhy{}axis whose values correspond to the y\PYZus{}axis list and is used}
         \PY{l+s+sd}{        in the return to specify the position of the peaks. If omitted an}
         \PY{l+s+sd}{        index of the y\PYZus{}axis is used.}
         \PY{l+s+sd}{        (default: None)}
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    lookahead \PYZhy{}\PYZhy{} distance to look ahead from a peak candidate to determine if}
         \PY{l+s+sd}{        it is the actual peak}
         \PY{l+s+sd}{        (default: 200) }
         \PY{l+s+sd}{        \PYZsq{}(samples / period) / f\PYZsq{} where \PYZsq{}4 \PYZgt{}= f \PYZgt{}= 1.25\PYZsq{} might be a good value}
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    delta \PYZhy{}\PYZhy{} this specifies a minimum difference between a peak and}
         \PY{l+s+sd}{        the following points, before a peak may be considered a peak. Useful}
         \PY{l+s+sd}{        to hinder the function from picking up false peaks towards to end of}
         \PY{l+s+sd}{        the signal. To work well delta should be set to delta \PYZgt{}= RMSnoise * 5.}
         \PY{l+s+sd}{        (default: 0)}
         \PY{l+s+sd}{            When omitted delta function causes a 20\PYZpc{} decrease in speed.}
         \PY{l+s+sd}{            When used Correctly it can double the speed of the function}
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    return: two lists [max\PYZus{}peaks, min\PYZus{}peaks] containing the positive and}
         \PY{l+s+sd}{        negative peaks respectively. Each cell of the lists contains a tuple}
         \PY{l+s+sd}{        of: (position, peak\PYZus{}value) }
         \PY{l+s+sd}{        to get the average peak value do: np.mean(max\PYZus{}peaks, 0)[1] on the}
         \PY{l+s+sd}{        results to unpack one of the lists into x, y coordinates do: }
         \PY{l+s+sd}{        x, y = zip(*max\PYZus{}peaks)}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{max\PYZus{}peaks} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{min\PYZus{}peaks} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{dump} \PY{o}{=} \PY{p}{[}\PY{p}{]}   \PY{c+c1}{\PYZsh{}Used to pop the first hit which almost always is false}
                
             \PY{c+c1}{\PYZsh{} check input data}
             \PY{n}{x\PYZus{}axis}\PY{p}{,} \PY{n}{y\PYZus{}axis} \PY{o}{=} \PY{n}{\PYZus{}datacheck\PYZus{}peakdetect}\PY{p}{(}\PY{n}{x\PYZus{}axis}\PY{p}{,} \PY{n}{y\PYZus{}axis}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} store data length for later use}
             \PY{n}{length} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{y\PYZus{}axis}\PY{p}{)}
             
             
             \PY{c+c1}{\PYZsh{}perform some checks}
             \PY{k}{if} \PY{n}{lookahead} \PY{o}{\PYZlt{}} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lookahead must be }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ or above in value}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{k}{if} \PY{o+ow}{not} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isscalar}\PY{p}{(}\PY{n}{delta}\PY{p}{)} \PY{o+ow}{and} \PY{n}{delta} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
                 \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{delta must be a positive number}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}maxima and minima candidates are temporarily stored in}
             \PY{c+c1}{\PYZsh{}mx and mn respectively}
             \PY{n}{mn}\PY{p}{,} \PY{n}{mx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{Inf}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{Inf}
             
             \PY{c+c1}{\PYZsh{}Only detect peak if there is \PYZsq{}lookahead\PYZsq{} amount of points after it}
             \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{x\PYZus{}axis}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{n}{lookahead}\PY{p}{]}\PY{p}{,} 
                                                 \PY{n}{y\PYZus{}axis}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{n}{lookahead}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{y} \PY{o}{\PYZgt{}} \PY{n}{mx}\PY{p}{:}
                     \PY{n}{mx} \PY{o}{=} \PY{n}{y}
                     \PY{n}{mxpos} \PY{o}{=} \PY{n}{x}
                 \PY{k}{if} \PY{n}{y} \PY{o}{\PYZlt{}} \PY{n}{mn}\PY{p}{:}
                     \PY{n}{mn} \PY{o}{=} \PY{n}{y}
                     \PY{n}{mnpos} \PY{o}{=} \PY{n}{x}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}look for max\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                 \PY{k}{if} \PY{n}{y} \PY{o}{\PYZlt{}} \PY{n}{mx}\PY{o}{\PYZhy{}}\PY{n}{delta} \PY{o+ow}{and} \PY{n}{mx} \PY{o}{!=} \PY{n}{np}\PY{o}{.}\PY{n}{Inf}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{}Maxima peak candidate found}
                     \PY{c+c1}{\PYZsh{}look ahead in signal to ensure that this is a peak and not jitter}
                     \PY{k}{if} \PY{n}{y\PYZus{}axis}\PY{p}{[}\PY{n}{index}\PY{p}{:}\PY{n}{index}\PY{o}{+}\PY{n}{lookahead}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{mx}\PY{p}{:}
                         \PY{n}{max\PYZus{}peaks}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{mxpos}\PY{p}{,} \PY{n}{mx}\PY{p}{]}\PY{p}{)}
                         \PY{n}{dump}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
                         \PY{c+c1}{\PYZsh{}set algorithm to only find minima now}
                         \PY{n}{mx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{Inf}
                         \PY{n}{mn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{Inf}
                         \PY{k}{if} \PY{n}{index}\PY{o}{+}\PY{n}{lookahead} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{length}\PY{p}{:}
                             \PY{c+c1}{\PYZsh{}end is within lookahead no more peaks can be found}
                             \PY{k}{break}
                         \PY{k}{continue}
                     \PY{c+c1}{\PYZsh{}else:  \PYZsh{}slows shit down this does}
                     \PY{c+c1}{\PYZsh{}    mx = ahead}
                     \PY{c+c1}{\PYZsh{}    mxpos = x\PYZus{}axis[np.where(y\PYZus{}axis[index:index+lookahead]==mx)]}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}look for min\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                 \PY{k}{if} \PY{n}{y} \PY{o}{\PYZgt{}} \PY{n}{mn}\PY{o}{+}\PY{n}{delta} \PY{o+ow}{and} \PY{n}{mn} \PY{o}{!=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{Inf}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{}Minima peak candidate found }
                     \PY{c+c1}{\PYZsh{}look ahead in signal to ensure that this is a peak and not jitter}
                     \PY{k}{if} \PY{n}{y\PYZus{}axis}\PY{p}{[}\PY{n}{index}\PY{p}{:}\PY{n}{index}\PY{o}{+}\PY{n}{lookahead}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{mn}\PY{p}{:}
                         \PY{n}{min\PYZus{}peaks}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{mnpos}\PY{p}{,} \PY{n}{mn}\PY{p}{]}\PY{p}{)}
                         \PY{n}{dump}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
                         \PY{c+c1}{\PYZsh{}set algorithm to only find maxima now}
                         \PY{n}{mn} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{Inf}
                         \PY{n}{mx} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{Inf}
                         \PY{k}{if} \PY{n}{index}\PY{o}{+}\PY{n}{lookahead} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{length}\PY{p}{:}
                             \PY{c+c1}{\PYZsh{}end is within lookahead no more peaks can be found}
                             \PY{k}{break}
                     \PY{c+c1}{\PYZsh{}else:  \PYZsh{}slows shit down this does}
                     \PY{c+c1}{\PYZsh{}    mn = ahead}
                     \PY{c+c1}{\PYZsh{}    mnpos = x\PYZus{}axis[np.where(y\PYZus{}axis[index:index+lookahead]==mn)]}
             
             
             \PY{c+c1}{\PYZsh{}Remove the false hit on the first value of the y\PYZus{}axis}
             \PY{k}{try}\PY{p}{:}
                 \PY{k}{if} \PY{n}{dump}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
                     \PY{n}{max\PYZus{}peaks}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{min\PYZus{}peaks}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{k}{del} \PY{n}{dump}
             \PY{k}{except} \PY{n+ne}{IndexError}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{}no peaks were found, should the function return empty lists?}
                 \PY{k}{pass}
                 
             \PY{k}{return} \PY{p}{[}\PY{n}{max\PYZus{}peaks}\PY{p}{,} \PY{n}{min\PYZus{}peaks}\PY{p}{]}
\end{Verbatim}


    \hypertarget{gruxe1fico-interactivo-para-la-eliminaciuxf3n-de-falsos-positivos}{%
\paragraph{Gráfico interactivo para la eliminación de falsos
positivos}\label{gruxe1fico-interactivo-para-la-eliminaciuxf3n-de-falsos-positivos}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}
         \PY{k+kn}{from} \PY{n+nn}{ipywidgets} \PY{k}{import} \PY{o}{*}
         
         \PY{n}{w\PYZus{}lookahead} \PY{o}{=} \PY{n}{IntSlider}\PY{p}{(}\PY{n+nb}{min}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{max}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{step}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{value}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{wc\PYZus{}lookahead} \PY{o}{=} \PY{n}{VBox}\PY{p}{(}\PY{p}{[}\PY{n}{Label}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lookahead}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{w\PYZus{}lookahead}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{w\PYZus{}delta} \PY{o}{=} \PY{n}{IntSlider}\PY{p}{(}\PY{n+nb}{min}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{max}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{step}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{value}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{wc\PYZus{}delta} \PY{o}{=} \PY{n}{VBox}\PY{p}{(}\PY{p}{[}\PY{n}{Label}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Delta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{w\PYZus{}delta}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{wc\PYZus{}controllers} \PY{o}{=} \PY{n}{HBox}\PY{p}{(}\PY{p}{[}\PY{n}{wc\PYZus{}lookahead}\PY{p}{,} \PY{n}{wc\PYZus{}delta}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{w\PYZus{}maxima\PYZus{}label} \PY{o}{=} \PY{n}{Label}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Máximos}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}maxima\PYZus{}label}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{width} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{90}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{w\PYZus{}maxima\PYZus{}selector} \PY{o}{=} \PY{n}{SelectMultiple}\PY{p}{(}\PY{n}{options}\PY{o}{=}\PY{p}{[}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{w\PYZus{}maxima\PYZus{}clean} \PY{o}{=} \PY{n}{Button}\PY{p}{(}\PY{n}{description}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Limpiar seleción de máximos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}maxima\PYZus{}clean}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{margin} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5px 2px 0}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{w\PYZus{}maxima\PYZus{}clean}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{width} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{300px}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{wc\PYZus{}maxima} \PY{o}{=} \PY{n}{VBox}\PY{p}{(}\PY{p}{[}\PY{n}{w\PYZus{}maxima\PYZus{}label}\PY{p}{,} \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{p}{,} \PY{n}{w\PYZus{}maxima\PYZus{}clean}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{w\PYZus{}minima\PYZus{}label} \PY{o}{=} \PY{n}{Label}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mínimos}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}minima\PYZus{}label}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{width} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{90}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{w\PYZus{}minima\PYZus{}selector} \PY{o}{=} \PY{n}{SelectMultiple}\PY{p}{(}\PY{n}{options}\PY{o}{=}\PY{p}{[}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{w\PYZus{}minima\PYZus{}clean} \PY{o}{=} \PY{n}{Button}\PY{p}{(}\PY{n}{description}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Limpiar seleción de mínimos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}minima\PYZus{}clean}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{margin} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5px 2px 0}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{w\PYZus{}minima\PYZus{}clean}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{width} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{300px}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{wc\PYZus{}minima} \PY{o}{=} \PY{n}{VBox}\PY{p}{(}\PY{p}{[}\PY{n}{w\PYZus{}minima\PYZus{}label}\PY{p}{,} \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{p}{,} \PY{n}{w\PYZus{}minima\PYZus{}clean}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{wc\PYZus{}peaks} \PY{o}{=} \PY{n}{HBox}\PY{p}{(}\PY{p}{[}\PY{n}{wc\PYZus{}maxima}\PY{p}{,} \PY{n}{wc\PYZus{}minima}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{w\PYZus{}message} \PY{o}{=} \PY{n}{Label}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Selecione los máximos y mínimos que desea eliminar.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}message}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{margin} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5px 0}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{w\PYZus{}message}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{width} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{600px}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{w\PYZus{}message}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{maxWidth} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{wc\PYZus{}message} \PY{o}{=} \PY{n}{VBox}\PY{p}{(}\PY{p}{[}\PY{n}{w\PYZus{}message}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{w\PYZus{}output} \PY{o}{=} \PY{n}{Output}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{wc\PYZus{}container} \PY{o}{=} \PY{n}{VBox}\PY{p}{(}\PY{p}{[}\PY{n}{wc\PYZus{}controllers}\PY{p}{,} \PY{n}{wc\PYZus{}message}\PY{p}{,} \PY{n}{wc\PYZus{}peaks}\PY{p}{,} \PY{n}{w\PYZus{}output}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{fig} \PY{o}{=} \PY{k+kc}{None}
         
         \PY{k}{def} \PY{n+nf}{update\PYZus{}peaks}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{)}\PY{p}{:}
             \PY{n}{maxima}\PY{p}{,} \PY{n}{minima} \PY{o}{=} \PY{n}{peakdetect}\PY{p}{(}
                 \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,}
                 \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{values}\PY{p}{,}
                 \PY{n}{lookahead}\PY{o}{=}\PY{n}{w\PYZus{}lookahead}\PY{o}{.}\PY{n}{value}\PY{p}{,}
                 \PY{n}{delta}\PY{o}{=}\PY{n}{w\PYZus{}delta}\PY{o}{.}\PY{n}{value}\PY{p}{)}
         
             \PY{n}{wc\PYZus{}maxima}\PY{o}{.}\PY{n}{children}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{value} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Máximos (}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{maxima}\PY{p}{)}\PY{p}{)}
             \PY{n}{wc\PYZus{}minima}\PY{o}{.}\PY{n}{children}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{value} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Mínimos (}\PY{l+s+si}{\PYZob{}0:\PYZcb{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{minima}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{minima} \PY{o}{=} \PY{p}{[}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2d\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{d}\PY{p}{)}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y\PYZhy{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{+}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZob{}0:.3f\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{v}\PY{p}{)} \PY{k}{for} \PY{n}{n}\PY{p}{,} \PY{p}{(}\PY{n}{d}\PY{p}{,} \PY{n}{v}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{minima}\PY{p}{)}
             \PY{p}{]}
             \PY{n}{maxima} \PY{o}{=} \PY{p}{[}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2d\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{d}\PY{p}{)}\PY{o}{.}\PY{n}{strftime}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{Y\PYZhy{}}\PY{l+s+s2}{\PYZpc{}}\PY{l+s+s2}{m}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{+}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ (}\PY{l+s+si}{\PYZob{}0:.3f\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{v}\PY{p}{)} \PY{k}{for} \PY{n}{n}\PY{p}{,} \PY{p}{(}\PY{n}{d}\PY{p}{,} \PY{n}{v}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{maxima}\PY{p}{)}
             \PY{p}{]}
         
             \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{o}{.}\PY{n}{options} \PY{o}{=} \PY{n}{minima}
             \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{o}{.}\PY{n}{options} \PY{o}{=} \PY{n}{maxima}
         
         
         \PY{k}{def} \PY{n+nf}{clean\PYZus{}peaks}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{args}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{w\PYZus{}maxima\PYZus{}clean}\PY{p}{:}
                 \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{o}{.}\PY{n}{value} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
             \PY{k}{elif} \PY{n}{args}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{w\PYZus{}minima\PYZus{}clean}\PY{p}{:}
                 \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{o}{.}\PY{n}{value} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
             \PY{k}{else}\PY{p}{:}
                 \PY{k}{pass}
         
             
         \PY{k}{def} \PY{n+nf}{plotter}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{)}\PY{p}{:}
             \PY{k}{global} \PY{n}{fig}
             
             \PY{n}{maxima} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}
                 \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                          \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{o}{*}\PY{n}{x}\PY{p}{)}\PY{p}{,}
                              \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{int}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                                  \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                      \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                          \PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{o}{.}\PY{n}{value}\PY{p}{,}
                                                 \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{o}{.}\PY{n}{options}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{minima} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}
                 \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                          \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{o}{*}\PY{n}{x}\PY{p}{)}\PY{p}{,}
                              \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{int}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                                  \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                      \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                          \PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{o}{.}\PY{n}{value}\PY{p}{,}
                                                 \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{o}{.}\PY{n}{options}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             
             \PY{k}{if} \PY{n}{fig} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{fig}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
                 
             \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{111}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{n}{gsn\PYZus{}smooth}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}
             \PY{p}{)}
         
             \PY{n}{gmaxima}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{maxima}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                 \PY{n}{maxima}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
                 \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZca{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{p}{)}
         
             \PY{n}{gminima}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{minima}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
                 \PY{n}{minima}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
                 \PY{n}{marker}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{p}{)}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sn\PYZus{}daily}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mathrm}\PY{l+s+si}{\PYZob{}Fecha\PYZcb{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{o}{/}\PY{l+m+mf}{100.0}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mathrm}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ (Promedio}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ Suaviado)\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{w\PYZus{}lookahead}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{update\PYZus{}peaks}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}lookahead}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{plotter}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{w\PYZus{}delta}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{update\PYZus{}peaks}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}delta}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{plotter}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{plotter}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}maxima\PYZus{}clean}\PY{o}{.}\PY{n}{on\PYZus{}click}\PY{p}{(}\PY{n}{clean\PYZus{}peaks}\PY{p}{)}
         
         \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{plotter}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}minima\PYZus{}clean}\PY{o}{.}\PY{n}{on\PYZus{}click}\PY{p}{(}\PY{n}{clean\PYZus{}peaks}\PY{p}{)}
         
         \PY{n}{wc\PYZus{}container}\PY{o}{.}\PY{n}{on\PYZus{}displayed}\PY{p}{(}\PY{n}{update\PYZus{}peaks}\PY{p}{)}
         \PY{n}{wc\PYZus{}container}\PY{o}{.}\PY{n}{on\PYZus{}displayed}\PY{p}{(}\PY{n}{plotter}\PY{p}{)}
         
         \PY{n}{display}\PY{p}{(}\PY{n}{wc\PYZus{}container}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
VBox(children=(HBox(children=(VBox(children=(Label(value='Lookahead'), IntSlider(value=20, min=1))), VBox(chil…
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_70_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{consturcciuxf3n-del-ciclo-promedio-entre-muxednimos}{%
\subsubsection{Consturcción del ciclo promedio entre
mínimos}\label{consturcciuxf3n-del-ciclo-promedio-entre-muxednimos}}

    \hypertarget{divisiuxf3n-de-ciclos-entre-muxednimos}{%
\paragraph{División de ciclos entre
mínimos}\label{divisiuxf3n-de-ciclos-entre-muxednimos}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{minima} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}
                 \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                          \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{o}{*}\PY{n}{x}\PY{p}{)}\PY{p}{,}
                              \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{int}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                                  \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                      \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                          \PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{o}{.}\PY{n}{value}\PY{p}{,}
                                                 \PY{n}{w\PYZus{}minima\PYZus{}selector}\PY{o}{.}\PY{n}{options}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{maxima} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}
             \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                      \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{o}{*}\PY{n}{x}\PY{p}{)}\PY{p}{,}
                          \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{int}\PY{p}{,} \PY{n}{x}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}
                              \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                  \PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
                                      \PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{x} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{o}{.}\PY{n}{value}\PY{p}{,}
                                             \PY{n}{w\PYZus{}maxima\PYZus{}selector}\PY{o}{.}\PY{n}{options}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{stops} \PY{o}{=} \PY{p}{[}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{minima}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         \PY{n}{lengths} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{get\PYZus{}loc}\PY{p}{,} \PY{n}{stops}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{maxlength} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lengths}\PY{p}{)}
         
         \PY{n}{headers} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}\PY{p}{]}
         \PY{n}{lcycles} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{dfcycles} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{maxlength}\PY{p}{,} \PY{l+m+mi}{3}\PY{o}{*}\PY{n+nb}{len}\PY{p}{(}\PY{n}{stops}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{stops}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{h} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cycle }\PY{l+s+si}{\PYZob{}0:\PYZgt{}2d\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{6}\PY{p}{)}
             
             \PY{n}{c} \PY{o}{=} \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
             
             \PY{k}{if} \PY{n}{i} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}\PY{n}{stops}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{n}{c} \PY{o}{=} \PY{n}{c}\PY{p}{[}\PY{n}{stops}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{:}\PY{p}{]}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{c} \PY{o}{=} \PY{n}{c}\PY{p}{[}\PY{n}{stops}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{:}\PY{n}{stops}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{pd}\PY{o}{.}\PY{n}{Timedelta}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
             
             \PY{n}{lcycles}\PY{p}{[}\PY{n}{h}\PY{p}{]} \PY{o}{=} \PY{n}{c}
             \PY{n}{v} \PY{o}{=} \PY{n}{c}\PY{o}{.}\PY{n}{values}
             \PY{n}{l} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{c}\PY{p}{)}
             
             \PY{n}{headers}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{3}\PY{o}{*}\PY{p}{[}\PY{n}{h}\PY{p}{]}
             \PY{n}{headers}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{c}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
             \PY{n}{dfcycles}\PY{p}{[}\PY{p}{:}\PY{n}{l}\PY{p}{,} \PY{l+m+mi}{0}\PY{o}{+}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{i}\PY{p}{:}\PY{l+m+mi}{0}\PY{o}{+}\PY{l+m+mi}{3}\PY{o}{*}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{=} \PY{n}{v}
         
         \PY{n}{dfcycles}\PY{p}{[}\PY{n}{dfcycles} \PY{o}{==} \PY{k+kc}{None}\PY{p}{]} \PY{o}{=} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
         \PY{n}{solar\PYZus{}cycles} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{dfcycles}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{headers}\PY{p}{)}
         \PY{n}{solar\PYZus{}cycles}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:}        Cycle  6                            Cycle  7                        \textbackslash{}
                      SN   SN value   SN error            SN   SN value   SN error   
         0    50.0+/-0.6    49.9827   0.597472   0.14+/-0.11    0.14296   0.113315   
         1    49.7+/-0.6    49.7207   0.601471   1.56+/-0.13    1.55963   0.134979   
         2    48.1+/-0.6    48.0989    0.59904   4.48+/-0.26    4.47629   0.257959   
         3    45.6+/-0.6    45.6038   0.578456     6.0+/-0.4    5.97629   0.407293   
         4    42.3+/-0.6     42.285   0.559415     5.9+/-0.4    5.93606     0.4062   
         5    39.9+/-0.5    39.8514   0.546668     7.2+/-0.4    7.23958   0.419884   
         6    40.0+/-0.6    39.9833   0.551675     8.8+/-0.5    8.77632   0.458498   
         7    39.8+/-0.6    39.8422   0.557115     9.0+/-0.5     8.9693   0.460742   
         8    38.7+/-0.5    38.6894   0.548512     8.9+/-0.5    8.93805   0.460488   
         9    37.6+/-0.5    37.6295   0.536525     9.0+/-0.5    9.00402   0.461271   
         10   38.3+/-0.5    38.3209   0.540186    10.5+/-0.5    10.5289   0.468485   
         11   39.6+/-0.5    39.6274   0.534121    13.7+/-0.5    13.7065   0.488122   
         12   39.0+/-0.5    39.0121   0.513708    15.5+/-0.5    15.4565    0.50127   
         13   38.5+/-0.5    38.4742   0.495247    14.1+/-0.5    14.0982   0.486626   
         14   38.9+/-0.5    38.9315   0.510161    11.6+/-0.4    11.5904   0.365733   
         15   38.9+/-0.5    38.9207   0.505049  11.52+/-0.33    11.5191   0.326228   
         16   39.5+/-0.5    39.5379   0.513009  14.16+/-0.34    14.1559   0.344625   
         17   38.5+/-0.5    38.5356   0.511406  14.63+/-0.31    14.6308   0.311835   
         18   36.1+/-0.5    36.0913    0.49555  14.43+/-0.30    14.4274   0.297615   
         19   35.3+/-0.5    35.3136   0.518473  16.38+/-0.31    16.3762   0.312997   
         20   34.6+/-0.5    34.6254   0.527317  19.59+/-0.33    19.5905   0.330583   
         21   32.7+/-0.5    32.6588   0.512947  23.42+/-0.35     23.421   0.353154   
         22   30.2+/-0.5    30.1762   0.496869  24.77+/-0.35    24.7679   0.351185   
         23   27.5+/-0.5     27.493   0.481121  23.76+/-0.34    23.7633   0.340413   
         24   26.2+/-0.5    26.1664   0.480958  23.91+/-0.35    23.9114   0.349499   
         25   24.8+/-0.5    24.7765   0.488813    26.2+/-0.4    26.1987   0.366094   
         26   23.3+/-0.5    23.3049   0.480506    28.5+/-0.4    28.5468   0.384727   
         27   22.7+/-0.5    22.6799    0.47007    29.6+/-0.4    29.6043   0.391095   
         28   20.0+/-0.5    20.0493    0.45156    30.8+/-0.4    30.7826   0.392642   
         29   17.5+/-0.4    17.5056   0.438749    33.2+/-0.4    33.1841   0.412175   
         ..          {\ldots}        {\ldots}        {\ldots}           {\ldots}        {\ldots}        {\ldots}   
         121   nan+/-nan  nan+/-nan  nan+/-nan  15.40+/-0.31    15.4009   0.306588   
         122   nan+/-nan  nan+/-nan  nan+/-nan  13.74+/-0.30     13.743   0.298176   
         123   nan+/-nan  nan+/-nan  nan+/-nan  13.52+/-0.30      13.52   0.296363   
         124   nan+/-nan  nan+/-nan  nan+/-nan  13.19+/-0.30    13.1916   0.298494   
         125   nan+/-nan  nan+/-nan  nan+/-nan  12.55+/-0.30    12.5537   0.295763   
         126   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         127   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         128   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         129   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         130   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         131   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         132   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         133   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         134   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         135   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         136   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         137   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         138   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         139   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         140   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         141   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         142   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         143   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         144   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         145   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         146   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         147   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         148   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         149   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         150   nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan  nan+/-nan  nan+/-nan   
         
                  Cycle  8                            Cycle  9    {\ldots}       Cycle 21  \textbackslash{}
                        SN   SN value   SN error            SN    {\ldots}       SN error   
         0    12.18+/-0.29    12.1817   0.288467  17.61+/-0.31    {\ldots}       0.145938   
         1    12.38+/-0.29    12.3779   0.292801  18.12+/-0.31    {\ldots}       0.148529   
         2    12.97+/-0.30    12.9704   0.295916  19.26+/-0.32    {\ldots}       0.148329   
         3    12.97+/-0.30    12.9678   0.299793  20.41+/-0.33    {\ldots}       0.146854   
         4    12.84+/-0.29    12.8427   0.288228  20.53+/-0.33    {\ldots}       0.150506   
         5    14.04+/-0.30    14.0363   0.298619  19.39+/-0.33    {\ldots}       0.156703   
         6    16.95+/-0.33    16.9509    0.33324  19.72+/-0.33    {\ldots}       0.158495   
         7      20.4+/-0.4    20.3705   0.376213  21.36+/-0.34    {\ldots}       0.153871   
         8      22.2+/-0.4    22.2484   0.406749  22.40+/-0.35    {\ldots}       0.154059   
         9      22.9+/-0.4    22.8657   0.403567    23.7+/-0.4    {\ldots}       0.159083   
         10     24.4+/-0.4    24.3991   0.428366    24.3+/-0.4    {\ldots}       0.172128   
         11     29.7+/-0.5    29.6542   0.465529    24.3+/-0.4    {\ldots}       0.176304   
         12     36.2+/-0.5    36.2284   0.531266    26.0+/-0.4    {\ldots}       0.183566   
         13     40.4+/-0.6    40.3922   0.559695    29.2+/-0.4    {\ldots}       0.192976   
         14     45.7+/-0.6    45.6968   0.595361    33.3+/-0.4    {\ldots}       0.203844   
         15     53.1+/-0.7    53.0754   0.742335    37.8+/-0.5    {\ldots}       0.210743   
         16     63.1+/-1.0    63.1041   0.997845    42.9+/-0.5    {\ldots}       0.220124   
         17     74.2+/-1.1    74.1951    1.06351    47.3+/-0.5    {\ldots}       0.232935   
         18     83.9+/-1.1    83.9079    1.10019    49.9+/-0.5    {\ldots}       0.256839   
         19     91.7+/-1.1    91.7211    1.14301    51.1+/-0.5    {\ldots}       0.275355   
         20    100.3+/-1.2    100.349    1.20409    53.3+/-0.6    {\ldots}       0.295082   
         21    111.8+/-1.2    111.762     1.2384    56.2+/-0.6    {\ldots}       0.307148   
         22    123.0+/-1.3    122.996    1.28672    59.5+/-0.6    {\ldots}       0.321752   
         23    134.1+/-1.3    134.106     1.3209    64.1+/-0.6    {\ldots}       0.330206   
         24    144.5+/-1.4    144.471    1.35779    67.7+/-0.7    {\ldots}       0.338127   
         25    155.5+/-1.4    155.548    1.38322    69.1+/-0.6    {\ldots}       0.357334   
         26    165.9+/-1.4    165.871    1.41143    71.0+/-0.7    {\ldots}       0.373824   
         27    173.2+/-1.3    173.209    1.30383    73.3+/-0.7    {\ldots}       0.386164   
         28    176.2+/-1.3    176.193    1.25148    75.0+/-0.7    {\ldots}       0.401195   
         29    178.7+/-1.3    178.726     1.2685    78.2+/-0.7    {\ldots}       0.413843   
         ..            {\ldots}        {\ldots}        {\ldots}           {\ldots}    {\ldots}            {\ldots}   
         121     nan+/-nan  nan+/-nan  nan+/-nan    68.3+/-0.5    {\ldots}        0.17621   
         122     nan+/-nan  nan+/-nan  nan+/-nan    65.1+/-0.5    {\ldots}        0.18254   
         123     nan+/-nan  nan+/-nan  nan+/-nan    62.1+/-0.5    {\ldots}       0.181527   
         124     nan+/-nan  nan+/-nan  nan+/-nan    59.6+/-0.5    {\ldots}        0.17977   
         125     nan+/-nan  nan+/-nan  nan+/-nan    57.3+/-0.5    {\ldots}       0.175607   
         126     nan+/-nan  nan+/-nan  nan+/-nan    53.6+/-0.5    {\ldots}      nan+/-nan   
         127     nan+/-nan  nan+/-nan  nan+/-nan    48.7+/-0.4    {\ldots}      nan+/-nan   
         128     nan+/-nan  nan+/-nan  nan+/-nan    45.1+/-0.4    {\ldots}      nan+/-nan   
         129     nan+/-nan  nan+/-nan  nan+/-nan    41.9+/-0.4    {\ldots}      nan+/-nan   
         130     nan+/-nan  nan+/-nan  nan+/-nan    39.5+/-0.4    {\ldots}      nan+/-nan   
         131     nan+/-nan  nan+/-nan  nan+/-nan    39.3+/-0.4    {\ldots}      nan+/-nan   
         132     nan+/-nan  nan+/-nan  nan+/-nan    38.9+/-0.4    {\ldots}      nan+/-nan   
         133     nan+/-nan  nan+/-nan  nan+/-nan    37.9+/-0.4    {\ldots}      nan+/-nan   
         134     nan+/-nan  nan+/-nan  nan+/-nan    37.0+/-0.4    {\ldots}      nan+/-nan   
         135     nan+/-nan  nan+/-nan  nan+/-nan    35.0+/-0.4    {\ldots}      nan+/-nan   
         136     nan+/-nan  nan+/-nan  nan+/-nan  32.06+/-0.35    {\ldots}      nan+/-nan   
         137     nan+/-nan  nan+/-nan  nan+/-nan  29.62+/-0.34    {\ldots}      nan+/-nan   
         138     nan+/-nan  nan+/-nan  nan+/-nan  26.92+/-0.32    {\ldots}      nan+/-nan   
         139     nan+/-nan  nan+/-nan  nan+/-nan  24.47+/-0.31    {\ldots}      nan+/-nan   
         140     nan+/-nan  nan+/-nan  nan+/-nan  21.69+/-0.29    {\ldots}      nan+/-nan   
         141     nan+/-nan  nan+/-nan  nan+/-nan  19.67+/-0.27    {\ldots}      nan+/-nan   
         142     nan+/-nan  nan+/-nan  nan+/-nan  17.54+/-0.25    {\ldots}      nan+/-nan   
         143     nan+/-nan  nan+/-nan  nan+/-nan  14.17+/-0.23    {\ldots}      nan+/-nan   
         144     nan+/-nan  nan+/-nan  nan+/-nan  11.76+/-0.21    {\ldots}      nan+/-nan   
         145     nan+/-nan  nan+/-nan  nan+/-nan  10.32+/-0.20    {\ldots}      nan+/-nan   
         146     nan+/-nan  nan+/-nan  nan+/-nan   8.46+/-0.18    {\ldots}      nan+/-nan   
         147     nan+/-nan  nan+/-nan  nan+/-nan   7.28+/-0.16    {\ldots}      nan+/-nan   
         148     nan+/-nan  nan+/-nan  nan+/-nan   6.73+/-0.16    {\ldots}      nan+/-nan   
         149     nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan    {\ldots}      nan+/-nan   
         150     nan+/-nan  nan+/-nan  nan+/-nan     nan+/-nan    {\ldots}      nan+/-nan   
         
                  Cycle 22                            Cycle 23                     \textbackslash{}
                        SN   SN value   SN error            SN SN value  SN error   
         0    13.52+/-0.17    13.5204    0.17093  11.17+/-0.16   11.171  0.156323   
         1    14.65+/-0.17    14.6516   0.168023  11.59+/-0.16  11.5904  0.159557   
         2    16.59+/-0.17    16.5932      0.171  11.31+/-0.16  11.3068  0.158018   
         3    18.31+/-0.17    18.3099   0.174495  11.20+/-0.16  11.1987   0.15749   
         4    19.90+/-0.18    19.9042   0.175571  11.32+/-0.16  11.3151  0.156047   
         5    22.32+/-0.18    22.3249   0.181626  11.97+/-0.16    11.97  0.156178   
         6    25.46+/-0.18    25.4568   0.183435  13.39+/-0.16   13.387  0.157147   
         7    27.97+/-0.18    27.9732   0.182084  14.31+/-0.16  14.3054  0.156442   
         8    30.34+/-0.19    30.3367   0.185158  14.53+/-0.16  14.5275  0.157496   
         9    32.70+/-0.19    32.7029   0.192034  15.24+/-0.16  15.2399  0.161936   
         10   36.20+/-0.20    36.2029   0.196784  18.27+/-0.17  18.2704  0.167799   
         11   40.48+/-0.21    40.4834   0.208549  21.97+/-0.18  21.9716  0.177832   
         12   45.31+/-0.22     45.311   0.217657  24.37+/-0.18  24.3728  0.176709   
         13   51.00+/-0.23    51.0016   0.227255  27.17+/-0.18  27.1651  0.183744   
         14   55.08+/-0.24    55.0765   0.241535  30.44+/-0.19  30.4407  0.190334   
         15   60.93+/-0.26     60.932   0.256971  33.62+/-0.20  33.6203  0.197607   
         16   69.21+/-0.28    69.2123   0.282576  38.17+/-0.21  38.1669    0.2085   
         17   76.91+/-0.31    76.9085   0.311942  43.06+/-0.22  43.0615  0.223867   
         18   84.91+/-0.34    84.9092   0.336693  47.07+/-0.24  47.0689  0.241561   
         19     93.0+/-0.4    92.9758   0.360127  52.00+/-0.25  52.0014  0.250847   
         20    101.4+/-0.4    101.351     0.3796  58.40+/-0.26  58.4003  0.261037   
         21    114.3+/-0.4    114.269   0.406384  65.45+/-0.27  65.4487  0.273019   
         22    128.5+/-0.5    128.507   0.450706  72.02+/-0.29  72.0176  0.288409   
         23    141.1+/-0.5    141.125   0.494729  76.93+/-0.31  76.9334   0.30724   
         24    151.2+/-0.5    151.225   0.522942  80.79+/-0.32  80.7908  0.315936   
         25    156.9+/-0.5    156.919   0.535502  85.40+/-0.33  85.3981  0.329273   
         26    164.4+/-0.5    164.367   0.548333  89.78+/-0.35  89.7799  0.348687   
         27    176.1+/-0.6    176.097    0.56476    93.5+/-0.4  93.4994  0.360232   
         28    184.8+/-0.6    184.822    0.58765    96.4+/-0.4  96.3884  0.368344   
         29    190.7+/-0.6    190.725   0.594825    98.2+/-0.4  98.2445  0.368979   
         ..            {\ldots}        {\ldots}        {\ldots}           {\ldots}      {\ldots}       {\ldots}   
         121     nan+/-nan  nan+/-nan  nan+/-nan  26.16+/-0.18  26.1581  0.178127   
         122     nan+/-nan  nan+/-nan  nan+/-nan  24.97+/-0.18  24.9672  0.178128   
         123     nan+/-nan  nan+/-nan  nan+/-nan  25.85+/-0.17  25.8451  0.174718   
         124     nan+/-nan  nan+/-nan  nan+/-nan  25.95+/-0.17  25.9542  0.169125   
         125     nan+/-nan  nan+/-nan  nan+/-nan  23.67+/-0.16  23.6654  0.158269   
         126     nan+/-nan  nan+/-nan  nan+/-nan  21.06+/-0.15  21.0608  0.150368   
         127     nan+/-nan  nan+/-nan  nan+/-nan  20.19+/-0.15  20.1923  0.149143   
         128     nan+/-nan  nan+/-nan  nan+/-nan  19.77+/-0.15   19.766  0.151287   
         129     nan+/-nan  nan+/-nan  nan+/-nan  19.01+/-0.15  19.0133  0.149823   
         130     nan+/-nan  nan+/-nan  nan+/-nan  17.74+/-0.15  17.7355  0.146909   
         131     nan+/-nan  nan+/-nan  nan+/-nan  16.36+/-0.15  16.3596  0.145543   
         132     nan+/-nan  nan+/-nan  nan+/-nan  14.43+/-0.14  14.4337    0.1415   
         133     nan+/-nan  nan+/-nan  nan+/-nan  12.85+/-0.14  12.8546  0.136763   
         134     nan+/-nan  nan+/-nan  nan+/-nan  11.60+/-0.14  11.5979  0.137066   
         135     nan+/-nan  nan+/-nan  nan+/-nan   9.90+/-0.14  9.90225  0.136515   
         136     nan+/-nan  nan+/-nan  nan+/-nan   9.60+/-0.13  9.60177  0.134954   
         137     nan+/-nan  nan+/-nan  nan+/-nan   9.87+/-0.13   9.8735  0.134873   
         138     nan+/-nan  nan+/-nan  nan+/-nan   9.17+/-0.13  9.17345  0.132719   
         139     nan+/-nan  nan+/-nan  nan+/-nan   7.88+/-0.13  7.87618  0.130774   
         140     nan+/-nan  nan+/-nan  nan+/-nan   6.60+/-0.13  6.59908   0.13069   
         141     nan+/-nan  nan+/-nan  nan+/-nan   5.60+/-0.13  5.60177  0.130244   
         142     nan+/-nan  nan+/-nan  nan+/-nan   5.09+/-0.13  5.08851  0.130232   
         143     nan+/-nan  nan+/-nan  nan+/-nan   5.08+/-0.13  5.07928  0.130937   
         144     nan+/-nan  nan+/-nan  nan+/-nan   5.35+/-0.13  5.34782  0.131862   
         145     nan+/-nan  nan+/-nan  nan+/-nan   4.83+/-0.13  4.82874  0.128312   
         146     nan+/-nan  nan+/-nan  nan+/-nan   4.03+/-0.12  4.03438  0.124406   
         147     nan+/-nan  nan+/-nan  nan+/-nan   3.85+/-0.12   3.8473  0.122292   
         148     nan+/-nan  nan+/-nan  nan+/-nan   3.16+/-0.12  3.15619  0.120857   
         149     nan+/-nan  nan+/-nan  nan+/-nan   2.44+/-0.12  2.43661  0.119435   
         150     nan+/-nan  nan+/-nan  nan+/-nan   2.27+/-0.12  2.26945  0.115798   
         
                  Cycle 24                        
                        SN   SN value   SN error  
         0     2.25+/-0.11    2.24812   0.114798  
         1     2.50+/-0.12    2.49965   0.117777  
         2     2.69+/-0.12    2.69051     0.1193  
         3     2.92+/-0.12    2.92429   0.118083  
         4     3.32+/-0.12    3.31802   0.116694  
         5     3.47+/-0.12    3.47424   0.118736  
         6     4.12+/-0.12    4.12106   0.124215  
         7     5.51+/-0.13    5.51354   0.130302  
         8     7.41+/-0.13    7.40731   0.131698  
         9     9.52+/-0.14    9.51747   0.136825  
         10   10.87+/-0.14    10.8698   0.143406  
         11   11.71+/-0.15    11.7073   0.147966  
         12   12.69+/-0.15    12.6852   0.150644  
         13   14.03+/-0.15    14.0272   0.152904  
         14   16.08+/-0.16    16.0837   0.158105  
         15   18.54+/-0.16    18.5384    0.16396  
         16   20.84+/-0.17    20.8398   0.170715  
         17   23.07+/-0.17    23.0676   0.174401  
         18   24.56+/-0.18    24.5562   0.175603  
         19   25.23+/-0.18    25.2269   0.178804  
         20   26.38+/-0.18    26.3792   0.182303  
         21   29.48+/-0.20    29.4819   0.195033  
         22   34.50+/-0.21     34.499   0.213883  
         23   39.08+/-0.23    39.0833   0.226349  
         24   42.48+/-0.23    42.4815    0.23398  
         25   45.67+/-0.24    45.6714   0.240324  
         26   48.82+/-0.25    48.8166   0.246486  
         27   53.81+/-0.26    53.8149   0.258722  
         28   61.14+/-0.29    61.1398   0.285297  
         29   69.34+/-0.31     69.337   0.312574  
         ..            {\ldots}        {\ldots}        {\ldots}  
         121     nan+/-nan  nan+/-nan  nan+/-nan  
         122     nan+/-nan  nan+/-nan  nan+/-nan  
         123     nan+/-nan  nan+/-nan  nan+/-nan  
         124     nan+/-nan  nan+/-nan  nan+/-nan  
         125     nan+/-nan  nan+/-nan  nan+/-nan  
         126     nan+/-nan  nan+/-nan  nan+/-nan  
         127     nan+/-nan  nan+/-nan  nan+/-nan  
         128     nan+/-nan  nan+/-nan  nan+/-nan  
         129     nan+/-nan  nan+/-nan  nan+/-nan  
         130     nan+/-nan  nan+/-nan  nan+/-nan  
         131     nan+/-nan  nan+/-nan  nan+/-nan  
         132     nan+/-nan  nan+/-nan  nan+/-nan  
         133     nan+/-nan  nan+/-nan  nan+/-nan  
         134     nan+/-nan  nan+/-nan  nan+/-nan  
         135     nan+/-nan  nan+/-nan  nan+/-nan  
         136     nan+/-nan  nan+/-nan  nan+/-nan  
         137     nan+/-nan  nan+/-nan  nan+/-nan  
         138     nan+/-nan  nan+/-nan  nan+/-nan  
         139     nan+/-nan  nan+/-nan  nan+/-nan  
         140     nan+/-nan  nan+/-nan  nan+/-nan  
         141     nan+/-nan  nan+/-nan  nan+/-nan  
         142     nan+/-nan  nan+/-nan  nan+/-nan  
         143     nan+/-nan  nan+/-nan  nan+/-nan  
         144     nan+/-nan  nan+/-nan  nan+/-nan  
         145     nan+/-nan  nan+/-nan  nan+/-nan  
         146     nan+/-nan  nan+/-nan  nan+/-nan  
         147     nan+/-nan  nan+/-nan  nan+/-nan  
         148     nan+/-nan  nan+/-nan  nan+/-nan  
         149     nan+/-nan  nan+/-nan  nan+/-nan  
         150     nan+/-nan  nan+/-nan  nan+/-nan  
         
         [151 rows x 57 columns]
\end{Verbatim}
            
    \hypertarget{gruxe1fico-interactivo-para-la-seleciuxf3n-de-ciclos}{%
\paragraph{Gráfico interactivo para la seleción de
ciclos}\label{gruxe1fico-interactivo-para-la-seleciuxf3n-de-ciclos}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{headers} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{solar\PYZus{}cycles}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{levels}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}
         \PY{n}{deleted\PYZus{}cycles} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{n}{w\PYZus{}cycles\PYZus{}label} \PY{o}{=} \PY{n}{Label}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ciclos solares}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{w\PYZus{}cycles\PYZus{}selector} \PY{o}{=} \PY{n}{SelectMultiple}\PY{p}{(}\PY{n}{options}\PY{o}{=}\PY{n}{headers}\PY{p}{,} \PY{n}{value}\PY{o}{=}\PY{n}{headers}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{+}\PY{p}{[}\PY{n}{headers}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
         \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{height} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{150px}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{w\PYZus{}cycles\PYZus{}clean} \PY{o}{=} \PY{n}{Button}\PY{p}{(}\PY{n}{description}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Limpiar seleción de ciclos}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}cycles\PYZus{}clean}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{margin} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{5px 2px 0}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{w\PYZus{}cycles\PYZus{}clean}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{width} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{300px}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{w\PYZus{}message} \PY{o}{=} \PY{n}{Label}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Selecione los ciclos que desea eliminar.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}message}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{maxWidth} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{w\PYZus{}log} \PY{o}{=} \PY{n}{HTML}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Log}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}log}\PY{o}{.}\PY{n}{layout}\PY{o}{.}\PY{n}{maxWidth} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{w\PYZus{}output} \PY{o}{=} \PY{n}{Output}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{wc\PYZus{}cycles} \PY{o}{=} \PY{n}{VBox}\PY{p}{(}\PY{p}{[}\PY{n}{w\PYZus{}message}\PY{p}{,} \PY{n}{w\PYZus{}cycles\PYZus{}label}\PY{p}{,} \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{p}{,} \PY{n}{w\PYZus{}cycles\PYZus{}clean}\PY{p}{,} \PY{n}{w\PYZus{}output}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{fig} \PY{o}{=} \PY{k+kc}{None}
         
         
         \PY{k}{def} \PY{n+nf}{select\PYZus{}cycles}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{)}\PY{p}{:}
             \PY{k}{global} \PY{n}{deleted\PYZus{}cycles}
             
             \PY{k}{if} \PY{n}{headers}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{deleted\PYZus{}cycles}\PY{p}{:}
                 \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{value} \PY{o}{=} \PY{n}{deleted\PYZus{}cycles} \PY{o}{+} \PY{p}{[}\PY{n}{headers}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
             
             \PY{n}{deleted\PYZus{}cycles} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{value}\PY{p}{)}\PY{p}{)}
             
             
         \PY{k}{def} \PY{n+nf}{plot\PYZus{}cycles}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{)}\PY{p}{:}
             \PY{k}{global} \PY{n}{fig}
             \PY{k}{global} \PY{n}{deleted\PYZus{}cycles}
             
             \PY{n}{deleted\PYZus{}cycles} \PY{o}{=} \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{value}
             
             \PY{k}{if} \PY{n}{fig} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{8.5}\PY{p}{,} \PY{l+m+mf}{3.5}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{fig}\PY{o}{.}\PY{n}{clf}\PY{p}{(}\PY{p}{)}
             
             \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{111}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 
             \PY{k}{for} \PY{n}{cycle} \PY{o+ow}{in} \PY{n}{lcycles}\PY{p}{:}
                 \PY{k}{if} \PY{n}{cycle} \PY{o+ow}{in} \PY{n}{deleted\PYZus{}cycles} \PY{o+ow}{or} \PY{n}{cycle} \PY{o}{==} \PY{n}{headers}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
                     \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}9e9e9e}\PY{l+s+s1}{\PYZsq{}}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}2196f3}\PY{l+s+s1}{\PYZsq{}}
                     
                 \PY{n}{gsmooth}\PY{p}{,} \PY{o}{=} \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                     \PY{n}{lcycles}\PY{p}{[}\PY{n}{cycle}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                     \PY{n}{color}\PY{o}{=}\PY{n}{color}\PY{p}{,}
                     \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{p}{)}
                 
             \PY{n}{util\PYZus{}cyles} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{Line2D}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}2196f3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mathrm}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{Ciclos}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{acute}\PY{l+s+si}{\PYZob{}u\PYZcb{}}\PY{l+s+s1}{tiles\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{no\PYZus{}util\PYZus{}cyles} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{Line2D}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}9e9e9e}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mathrm}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{Ciclos}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ descartados\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
                 \PY{n}{handles}\PY{o}{=}\PY{p}{[}\PY{n}{util\PYZus{}cyles}\PY{p}{,} \PY{n}{no\PYZus{}util\PYZus{}cyles}\PY{p}{]}\PY{p}{,}
                 \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.25}\PY{p}{)}\PY{p}{,}
                 \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                 \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
                 \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
                     
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{sn\PYZus{}smooth}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mathrm}\PY{l+s+si}{\PYZob{}Fecha\PYZcb{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{sn\PYZus{}smooth}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{o}{/}\PY{l+m+mf}{100.0}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{)}
             \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mathrm}\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{SN}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ (Promedio}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{ Suaviado)\PYZcb{}\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
             \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             
             
         \PY{k}{def} \PY{n+nf}{clean\PYZus{}cycles}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{)}\PY{p}{:}
             \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{value} \PY{o}{=} \PY{n}{headers}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}
         
             
         \PY{k}{def} \PY{n+nf}{delete\PYZus{}cycles}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{)}\PY{p}{:}
             \PY{k}{global} \PY{n}{deleted\PYZus{}cycles}
             
             \PY{n}{deleted\PYZus{}cycles} \PY{o}{=} \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{value}
             \PY{n}{w\PYZus{}cycles\PYZus{}delete}\PY{o}{.}\PY{n}{button\PYZus{}style} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{success}\PY{l+s+s1}{\PYZsq{}}
             
         \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{select\PYZus{}cycles}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{w\PYZus{}cycles\PYZus{}selector}\PY{o}{.}\PY{n}{observe}\PY{p}{(}\PY{n}{plot\PYZus{}cycles}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{w\PYZus{}cycles\PYZus{}clean}\PY{o}{.}\PY{n}{on\PYZus{}click}\PY{p}{(}\PY{n}{clean\PYZus{}cycles}\PY{p}{)}
         
         \PY{n}{wc\PYZus{}cycles}\PY{o}{.}\PY{n}{on\PYZus{}displayed}\PY{p}{(}\PY{n}{plot\PYZus{}cycles}\PY{p}{)}
         
         \PY{n}{display}\PY{p}{(}\PY{n}{wc\PYZus{}cycles}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
VBox(children=(Label(value='Selecione los ciclos que desea eliminar.'), Label(value='Ciclos solares'), SelectM…
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_75_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{ordenamiento-de-ciclos-selecionados}{%
\paragraph{Ordenamiento de ciclos
selecionados}\label{ordenamiento-de-ciclos-selecionados}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{selected\PYZus{}cycles} \PY{o}{=} \PY{n}{solar\PYZus{}cycles}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{cycle} \PY{o+ow}{in} \PY{n}{deleted\PYZus{}cycles}\PY{p}{:}
             \PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{cycle}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{preserved\PYZus{}cycles} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{labels}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{preserved\PYZus{}cycles} \PY{o}{=} \PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{levels}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{[}\PY{n}{preserved\PYZus{}cycles}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} for cycle in preserved\PYZus{}cycles:}
         \PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{level}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{n}{preserved\PYZus{}cycles}
         \PY{n}{selected\PYZus{}cycles}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}31}]:}          Cycle  9      Cycle 10      Cycle 11      Cycle 12      Cycle 13  \textbackslash{}
         0    17.61+/-0.31   6.00+/-0.15   9.87+/-0.19   3.75+/-0.14   8.28+/-0.18   
         1    18.12+/-0.31   6.33+/-0.16  10.02+/-0.19   4.15+/-0.15   9.65+/-0.19   
         2    19.26+/-0.32   6.89+/-0.16  10.00+/-0.19   5.41+/-0.16  10.94+/-0.20   
         3    20.41+/-0.33   7.47+/-0.17  11.92+/-0.21   6.21+/-0.17  11.67+/-0.21   
         4    20.53+/-0.33   7.41+/-0.16  14.87+/-0.24   7.03+/-0.17  12.31+/-0.21   
         5    19.39+/-0.33   7.29+/-0.16  16.99+/-0.25   8.43+/-0.18  14.38+/-0.23   
         6    19.72+/-0.33   7.90+/-0.17  19.14+/-0.26   9.53+/-0.20  16.24+/-0.24   
         7    21.36+/-0.34   9.28+/-0.19  22.39+/-0.28  11.60+/-0.21  17.92+/-0.25   
         8    22.40+/-0.35  10.52+/-0.20  26.16+/-0.30  15.06+/-0.23  21.75+/-0.27   
         9      23.7+/-0.4  11.11+/-0.21  29.83+/-0.32  18.25+/-0.26  27.54+/-0.30   
         10     24.3+/-0.4  11.86+/-0.21  33.49+/-0.34  20.50+/-0.27  34.07+/-0.33   
         11     24.3+/-0.4  14.48+/-0.23    37.1+/-0.4  22.88+/-0.28    39.1+/-0.4   
         12     26.0+/-0.4  17.60+/-0.26    41.6+/-0.4  26.38+/-0.30    43.3+/-0.4   
         13     29.2+/-0.4  19.85+/-0.27    47.3+/-0.4  29.42+/-0.32    48.7+/-0.4   
         14     33.3+/-0.4  22.10+/-0.29    53.9+/-0.4  33.02+/-0.33    53.7+/-0.4   
         15     37.8+/-0.5  25.97+/-0.31    60.0+/-0.4    39.8+/-0.4    57.7+/-0.4   
         16     42.9+/-0.5  31.83+/-0.35    65.8+/-0.5    46.1+/-0.4    63.3+/-0.5   
         17     47.3+/-0.5    36.6+/-0.4    72.1+/-0.5    49.4+/-0.4    70.8+/-0.5   
         18     49.9+/-0.5    40.8+/-0.4    77.0+/-0.5    52.2+/-0.4    77.3+/-0.5   
         19     51.1+/-0.5    45.2+/-0.4    79.1+/-0.5    54.6+/-0.4    83.5+/-0.5   
         20     53.3+/-0.6    49.4+/-0.4    84.8+/-0.5    57.3+/-0.4    89.5+/-0.5   
         21     56.2+/-0.6    55.7+/-0.5    95.5+/-0.6    61.3+/-0.5    94.2+/-0.6   
         22     59.5+/-0.6    61.9+/-0.5   103.0+/-0.6    65.8+/-0.5    97.4+/-0.6   
         23     64.1+/-0.6    65.1+/-0.5   108.2+/-0.6    69.4+/-0.5   103.3+/-0.6   
         24     67.7+/-0.7    68.4+/-0.5   113.7+/-0.6    72.6+/-0.5   108.7+/-0.6   
         25     69.1+/-0.6    73.4+/-0.5   115.9+/-0.6    78.3+/-0.5   110.6+/-0.6   
         26     71.0+/-0.7    79.1+/-0.6   117.0+/-0.6    82.8+/-0.5   113.6+/-0.6   
         27     73.3+/-0.7    85.2+/-0.6   120.9+/-0.6    82.6+/-0.5   118.4+/-0.6   
         28     75.0+/-0.7    92.2+/-0.6   124.6+/-0.6    83.2+/-0.5   122.0+/-0.6   
         29     78.2+/-0.7    97.8+/-0.6   129.6+/-0.7    86.4+/-0.5   122.2+/-0.6   
         ..            {\ldots}           {\ldots}           {\ldots}           {\ldots}           {\ldots}   
         121    68.3+/-0.5    43.3+/-0.4  21.44+/-0.27   9.22+/-0.19  17.69+/-0.20   
         122    65.1+/-0.5    39.9+/-0.4  21.21+/-0.27  10.91+/-0.20  17.46+/-0.20   
         123    62.1+/-0.5    36.8+/-0.4  21.08+/-0.28  11.99+/-0.21  16.52+/-0.20   
         124    59.6+/-0.5    35.5+/-0.4  19.20+/-0.26  11.83+/-0.21  15.17+/-0.19   
         125    57.3+/-0.5    34.0+/-0.4  17.59+/-0.25  11.10+/-0.21  13.75+/-0.18   
         126    53.6+/-0.5  31.87+/-0.35  17.16+/-0.25  10.37+/-0.20  12.67+/-0.18   
         127    48.7+/-0.4  28.48+/-0.33  15.79+/-0.24  10.69+/-0.21  11.27+/-0.17   
         128    45.1+/-0.4  22.99+/-0.29  13.61+/-0.22  10.46+/-0.20   9.81+/-0.16   
         129    41.9+/-0.4  18.80+/-0.26  11.99+/-0.21   9.80+/-0.20   9.02+/-0.16   
         130    39.5+/-0.4  16.59+/-0.25  11.04+/-0.21   9.50+/-0.19   8.05+/-0.15   
         131    39.3+/-0.4  14.80+/-0.24  10.20+/-0.20   9.47+/-0.19   7.30+/-0.15   
         132    38.9+/-0.4  12.81+/-0.22   8.95+/-0.19   9.28+/-0.19   6.53+/-0.15   
         133    37.9+/-0.4  11.28+/-0.20   7.76+/-0.18   9.07+/-0.19   5.35+/-0.14   
         134    37.0+/-0.4  10.31+/-0.19   6.67+/-0.17   8.38+/-0.18   4.67+/-0.13   
         135    35.0+/-0.4     nan+/-nan   5.86+/-0.17     nan+/-nan   4.60+/-0.13   
         136  32.06+/-0.35     nan+/-nan   5.59+/-0.16     nan+/-nan   4.95+/-0.14   
         137  29.62+/-0.34     nan+/-nan   5.01+/-0.16     nan+/-nan   5.15+/-0.14   
         138  26.92+/-0.32     nan+/-nan   4.04+/-0.15     nan+/-nan   5.54+/-0.14   
         139  24.47+/-0.31     nan+/-nan   3.92+/-0.15     nan+/-nan   6.09+/-0.15   
         140  21.69+/-0.29     nan+/-nan   4.11+/-0.15     nan+/-nan   5.58+/-0.14   
         141  19.67+/-0.27     nan+/-nan     nan+/-nan     nan+/-nan   4.76+/-0.13   
         142  17.54+/-0.25     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         143  14.17+/-0.23     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         144  11.76+/-0.21     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         145  10.32+/-0.20     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         146   8.46+/-0.18     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         147   7.28+/-0.16     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         148   6.73+/-0.16     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         149     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         150     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         
                  Cycle 14      Cycle 15      Cycle 16      Cycle 17      Cycle 18  \textbackslash{}
         0     4.47+/-0.13   2.44+/-0.12   9.36+/-0.16   5.79+/-0.14  12.88+/-0.17   
         1     4.57+/-0.13   2.47+/-0.12   9.51+/-0.16   5.97+/-0.14  12.99+/-0.18   
         2     5.15+/-0.14   2.64+/-0.12   9.77+/-0.16   7.70+/-0.15  13.91+/-0.18   
         3     6.51+/-0.14   3.96+/-0.13  11.35+/-0.17   8.95+/-0.16  14.58+/-0.19   
         4     7.83+/-0.15   5.47+/-0.14  13.60+/-0.18   9.50+/-0.16  15.28+/-0.19   
         5     8.35+/-0.16   6.63+/-0.15  16.34+/-0.20  10.50+/-0.17  16.98+/-0.20   
         6     8.62+/-0.16   7.68+/-0.15  19.35+/-0.21  10.99+/-0.17  18.85+/-0.21   
         7     9.99+/-0.16   8.46+/-0.16  21.48+/-0.22  11.11+/-0.17  20.44+/-0.21   
         8    11.25+/-0.17   9.78+/-0.16  23.27+/-0.23  11.86+/-0.17  23.38+/-0.23   
         9    13.14+/-0.18  10.94+/-0.17  25.10+/-0.24  13.47+/-0.18  27.54+/-0.24   
         10   15.78+/-0.20  12.38+/-0.18  26.91+/-0.25  15.58+/-0.19  31.66+/-0.26   
         11   17.63+/-0.20  14.76+/-0.19  28.21+/-0.25  17.53+/-0.20  36.43+/-0.28   
         12   20.53+/-0.22  17.45+/-0.20  29.81+/-0.26  19.71+/-0.21  39.67+/-0.29   
         13   24.24+/-0.23  21.61+/-0.22  32.19+/-0.27  21.08+/-0.22  41.74+/-0.30   
         14   26.33+/-0.24  26.83+/-0.24  34.73+/-0.27  21.67+/-0.22  46.77+/-0.31   
         15   28.14+/-0.24  30.98+/-0.26  37.68+/-0.28  24.90+/-0.23  52.82+/-0.33   
         16   32.08+/-0.26  34.58+/-0.27  40.84+/-0.29  29.32+/-0.25  55.20+/-0.34   
         17   37.56+/-0.28  40.49+/-0.29  43.19+/-0.30  32.55+/-0.27  57.15+/-0.35   
         18   42.27+/-0.30  49.08+/-0.32  45.20+/-0.31  36.70+/-0.28    64.3+/-0.4   
         19   44.40+/-0.31  57.97+/-0.35  48.93+/-0.32  42.65+/-0.30    73.2+/-0.4   
         20   46.56+/-0.31    64.8+/-0.4  54.40+/-0.34  49.80+/-0.32    80.1+/-0.4   
         21   49.37+/-0.32    70.5+/-0.4  59.93+/-0.35  56.86+/-0.34    86.9+/-0.4   
         22   52.27+/-0.33    75.5+/-0.4    68.1+/-0.4    63.1+/-0.4    93.3+/-0.4   
         23   55.77+/-0.34    78.1+/-0.4    78.5+/-0.4    69.9+/-0.4   101.0+/-0.5   
         24   59.12+/-0.35    80.5+/-0.4    86.3+/-0.4    77.4+/-0.4   111.7+/-0.5   
         25     62.7+/-0.4    83.0+/-0.4    92.6+/-0.4    85.5+/-0.4   121.5+/-0.5   
         26     66.1+/-0.4    85.9+/-0.4    96.2+/-0.5    91.8+/-0.4   128.0+/-0.5   
         27     68.5+/-0.4    89.9+/-0.4    98.2+/-0.5    95.3+/-0.4   135.7+/-0.5   
         28     69.1+/-0.4    94.9+/-0.4   101.4+/-0.5    98.3+/-0.5   147.7+/-0.6   
         29     69.3+/-0.4    97.7+/-0.4   104.2+/-0.5   103.5+/-0.5   157.7+/-0.6   
         ..            {\ldots}           {\ldots}           {\ldots}           {\ldots}           {\ldots}   
         121   5.07+/-0.13     nan+/-nan     nan+/-nan  17.99+/-0.20   6.24+/-0.08   
         122   5.20+/-0.13     nan+/-nan     nan+/-nan  15.38+/-0.19     nan+/-nan   
         123   5.72+/-0.14     nan+/-nan     nan+/-nan  14.38+/-0.19     nan+/-nan   
         124   5.64+/-0.14     nan+/-nan     nan+/-nan  13.63+/-0.18     nan+/-nan   
         125   5.72+/-0.14     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         126   6.15+/-0.14     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         127   6.49+/-0.14     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         128   6.37+/-0.14     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         129   5.81+/-0.14     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         130   5.25+/-0.14     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         131   4.66+/-0.13     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         132   4.28+/-0.13     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         133   4.20+/-0.13     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         134   3.61+/-0.13     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         135   2.93+/-0.12     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         136   2.79+/-0.12     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         137   2.58+/-0.12     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         138     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         139     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         140     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         141     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         142     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         143     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         144     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         145     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         146     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         147     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         148     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         149     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         150     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan     nan+/-nan   
         
                   Cycle 19       Cycle 20      Cycle 21      Cycle 22      Cycle 23  
         0      5.10+/-0.08   14.24+/-0.13  17.79+/-0.15  13.52+/-0.17  11.17+/-0.16  
         1      5.47+/-0.08   14.97+/-0.13  18.45+/-0.15  14.65+/-0.17  11.59+/-0.16  
         2      6.23+/-0.09   16.22+/-0.14  18.29+/-0.15  16.59+/-0.17  11.31+/-0.16  
         3      7.92+/-0.10   17.15+/-0.14  17.90+/-0.15  18.31+/-0.17  11.20+/-0.16  
         4     10.51+/-0.11   17.65+/-0.15  18.85+/-0.15  19.90+/-0.18  11.32+/-0.16  
         5     11.36+/-0.12   18.36+/-0.15  20.46+/-0.16  22.32+/-0.18  11.97+/-0.16  
         6     11.58+/-0.12   19.92+/-0.16  20.81+/-0.16  25.46+/-0.18  13.39+/-0.16  
         7     13.83+/-0.13   21.24+/-0.16  19.69+/-0.15  27.97+/-0.18  14.31+/-0.16  
         8     17.36+/-0.14   21.83+/-0.16  19.71+/-0.15  30.34+/-0.19  14.53+/-0.16  
         9     20.52+/-0.16   22.57+/-0.16  21.61+/-0.16  32.70+/-0.19  15.24+/-0.16  
         10    23.70+/-0.17   23.79+/-0.17  24.31+/-0.17  36.20+/-0.20  18.27+/-0.17  
         11    28.03+/-0.18   25.18+/-0.17  26.25+/-0.18  40.48+/-0.21  21.97+/-0.18  
         12    33.49+/-0.20   28.42+/-0.18  28.80+/-0.18  45.31+/-0.22  24.37+/-0.18  
         13    41.22+/-0.22   32.11+/-0.19  31.92+/-0.19  51.00+/-0.23  27.17+/-0.18  
         14    49.99+/-0.24   35.20+/-0.20  34.67+/-0.20  55.08+/-0.24  30.44+/-0.19  
         15    57.00+/-0.26   39.67+/-0.22  37.70+/-0.21  60.93+/-0.26  33.62+/-0.20  
         16    66.02+/-0.27   44.76+/-0.23  41.40+/-0.22  69.21+/-0.28  38.17+/-0.21  
         17    78.77+/-0.30   49.18+/-0.24  47.62+/-0.23  76.91+/-0.31  43.06+/-0.22  
         18    91.30+/-0.33   53.29+/-0.25  55.73+/-0.26  84.91+/-0.34  47.07+/-0.24  
         19   103.48+/-0.35   57.88+/-0.26  64.80+/-0.28    93.0+/-0.4  52.00+/-0.25  
         20     114.8+/-0.4   63.43+/-0.27  73.65+/-0.30   101.4+/-0.4  58.40+/-0.26  
         21     125.8+/-0.4   71.42+/-0.29  80.72+/-0.31   114.3+/-0.4  65.45+/-0.27  
         22     139.4+/-0.4   80.34+/-0.31  86.92+/-0.32   128.5+/-0.5  72.02+/-0.29  
         23     154.7+/-0.4   89.48+/-0.32  91.44+/-0.33   141.1+/-0.5  76.93+/-0.31  
         24     168.1+/-0.4   95.79+/-0.34  98.64+/-0.34   151.2+/-0.5  80.79+/-0.32  
         25     180.5+/-0.5   99.44+/-0.34   109.0+/-0.4   156.9+/-0.5  85.40+/-0.33  
         26     193.9+/-0.5  103.03+/-0.35   117.8+/-0.4   164.4+/-0.5  89.78+/-0.35  
         27     206.1+/-0.5  106.23+/-0.35   126.5+/-0.4   176.1+/-0.6    93.5+/-0.4  
         28     211.8+/-0.5    111.6+/-0.4   138.0+/-0.4   184.8+/-0.6    96.4+/-0.4  
         29     214.5+/-0.5    116.4+/-0.4   147.3+/-0.4   190.7+/-0.6    98.2+/-0.4  
         ..             {\ldots}            {\ldots}           {\ldots}           {\ldots}           {\ldots}  
         121   15.95+/-0.14   39.30+/-0.22  15.12+/-0.18     nan+/-nan  26.16+/-0.18  
         122   15.03+/-0.13   36.05+/-0.21  15.77+/-0.18     nan+/-nan  24.97+/-0.18  
         123   15.16+/-0.13   32.99+/-0.19  15.25+/-0.18     nan+/-nan  25.85+/-0.17  
         124   15.09+/-0.13   31.74+/-0.19  15.12+/-0.18     nan+/-nan  25.95+/-0.17  
         125   14.62+/-0.13   30.57+/-0.19  14.39+/-0.18     nan+/-nan  23.67+/-0.16  
         126      nan+/-nan   26.81+/-0.18     nan+/-nan     nan+/-nan  21.06+/-0.15  
         127      nan+/-nan   24.24+/-0.17     nan+/-nan     nan+/-nan  20.19+/-0.15  
         128      nan+/-nan   23.16+/-0.17     nan+/-nan     nan+/-nan  19.77+/-0.15  
         129      nan+/-nan   21.76+/-0.16     nan+/-nan     nan+/-nan  19.01+/-0.15  
         130      nan+/-nan   20.69+/-0.16     nan+/-nan     nan+/-nan  17.74+/-0.15  
         131      nan+/-nan   20.87+/-0.16     nan+/-nan     nan+/-nan  16.36+/-0.15  
         132      nan+/-nan   22.30+/-0.16     nan+/-nan     nan+/-nan  14.43+/-0.14  
         133      nan+/-nan   23.33+/-0.17     nan+/-nan     nan+/-nan  12.85+/-0.14  
         134      nan+/-nan   23.60+/-0.17     nan+/-nan     nan+/-nan  11.60+/-0.14  
         135      nan+/-nan   22.09+/-0.16     nan+/-nan     nan+/-nan   9.90+/-0.14  
         136      nan+/-nan   19.17+/-0.15     nan+/-nan     nan+/-nan   9.60+/-0.13  
         137      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   9.87+/-0.13  
         138      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   9.17+/-0.13  
         139      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   7.88+/-0.13  
         140      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   6.60+/-0.13  
         141      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   5.60+/-0.13  
         142      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   5.09+/-0.13  
         143      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   5.08+/-0.13  
         144      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   5.35+/-0.13  
         145      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   4.83+/-0.13  
         146      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   4.03+/-0.12  
         147      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   3.85+/-0.12  
         148      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   3.16+/-0.12  
         149      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   2.44+/-0.12  
         150      nan+/-nan      nan+/-nan     nan+/-nan     nan+/-nan   2.27+/-0.12  
         
         [151 rows x 15 columns]
\end{Verbatim}
            
    \hypertarget{separacion-de-ciclo-en-curso}{%
\paragraph{Separacion de ciclo en
curso}\label{separacion-de-ciclo-en-curso}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{current\PYZus{}cycle} \PY{o}{=} \PY{n}{solar\PYZus{}cycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{current\PYZus{}cycle}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Current Cycle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{current\PYZus{}cycle}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:}     Current Cycle
         0     2.25+/-0.11
         1     2.50+/-0.12
         2     2.69+/-0.12
         3     2.92+/-0.12
         4     3.32+/-0.12
         5     3.47+/-0.12
         6     4.12+/-0.12
         7     5.51+/-0.13
         8     7.41+/-0.13
         9     9.52+/-0.14
         10   10.87+/-0.14
         11   11.71+/-0.15
         12   12.69+/-0.15
         13   14.03+/-0.15
         14   16.08+/-0.16
         15   18.54+/-0.16
         16   20.84+/-0.17
         17   23.07+/-0.17
         18   24.56+/-0.18
         19   25.23+/-0.18
         20   26.38+/-0.18
         21   29.48+/-0.20
         22   34.50+/-0.21
         23   39.08+/-0.23
         24   42.48+/-0.23
         25   45.67+/-0.24
         26   48.82+/-0.25
         27   53.81+/-0.26
         28   61.14+/-0.29
         29   69.34+/-0.31
         ..            {\ldots}
         121     nan+/-nan
         122     nan+/-nan
         123     nan+/-nan
         124     nan+/-nan
         125     nan+/-nan
         126     nan+/-nan
         127     nan+/-nan
         128     nan+/-nan
         129     nan+/-nan
         130     nan+/-nan
         131     nan+/-nan
         132     nan+/-nan
         133     nan+/-nan
         134     nan+/-nan
         135     nan+/-nan
         136     nan+/-nan
         137     nan+/-nan
         138     nan+/-nan
         139     nan+/-nan
         140     nan+/-nan
         141     nan+/-nan
         142     nan+/-nan
         143     nan+/-nan
         144     nan+/-nan
         145     nan+/-nan
         146     nan+/-nan
         147     nan+/-nan
         148     nan+/-nan
         149     nan+/-nan
         150     nan+/-nan
         
         [151 rows x 1 columns]
\end{Verbatim}
            
    \hypertarget{cuxe1lculo-del-ciclo-promedio}{%
\paragraph{Cálculo del ciclo
promedio}\label{cuxe1lculo-del-ciclo-promedio}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{average\PYZus{}cycle} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nanmean}\PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{average\PYZus{}cycle} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{average\PYZus{}cycle}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Average Cycle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{average\PYZus{}cycle}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:}      Average Cycle
         0      9.49+/-0.04
         1      9.93+/-0.04
         2     10.69+/-0.04
         3     11.70+/-0.05
         4     12.80+/-0.05
         5     13.98+/-0.05
         6     15.28+/-0.05
         7     16.74+/-0.05
         8     18.61+/-0.06
         9     20.88+/-0.06
         10    23.52+/-0.06
         11    26.29+/-0.07
         12    29.50+/-0.07
         13    33.25+/-0.07
         14    37.18+/-0.08
         15    41.65+/-0.08
         16    46.76+/-0.09
         17    52.18+/-0.09
         18    57.80+/-0.10
         19    63.45+/-0.10
         20    69.43+/-0.10
         21    76.27+/-0.11
         22    83.14+/-0.11
         23    89.81+/-0.12
         24    96.05+/-0.12
         25   101.59+/-0.12
         26   106.69+/-0.13
         27   111.77+/-0.13
         28   116.74+/-0.13
         29   120.93+/-0.14
         ..             {\ldots}
         121   23.81+/-0.07
         122   24.27+/-0.08
         123   23.44+/-0.08
         124   22.58+/-0.08
         125   22.27+/-0.08
         126   22.46+/-0.09
         127   20.73+/-0.09
         128   18.91+/-0.08
         129   17.26+/-0.08
         130   16.04+/-0.08
         131   15.36+/-0.08
         132   14.68+/-0.07
         133   13.97+/-0.07
         134   13.23+/-0.07
         135   13.39+/-0.08
         136   12.36+/-0.08
         137   10.45+/-0.09
         138   11.42+/-0.10
         139   10.59+/-0.10
         140    9.49+/-0.09
         141   10.01+/-0.11
         142   11.31+/-0.14
         143    9.62+/-0.13
         144    8.56+/-0.12
         145    7.57+/-0.12
         146    6.25+/-0.11
         147    5.56+/-0.10
         148    4.94+/-0.10
         149    2.44+/-0.12
         150    2.27+/-0.12
         
         [151 rows x 1 columns]
\end{Verbatim}
            
    \hypertarget{grafico-del-ciclo-promedio-y-su-comparaciuxf3n-con-otros-ciclos-solares}{%
\paragraph{Grafico del ciclo promedio y su comparación con otros ciclos
solares}\label{grafico-del-ciclo-promedio-y-su-comparaciuxf3n-con-otros-ciclos-solares}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{8.5}\PY{p}{,} \PY{l+m+mf}{8.5}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{title} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Registro}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ diario}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ del}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ N}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{acute}\PY{l+s+si}{\PYZob{}u\PYZcb{}}\PY{l+s+s2}{mero}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Manchas}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Solares\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{k}{for} \PY{n}{cycle} \PY{o+ow}{in} \PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
             \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
                 \PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{p}{[}\PY{n}{cycle}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,}
                 \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,}
                 \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} 
                 \PY{n}{label}\PY{o}{=}\PY{n}{cycle}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{current\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Current Cycle}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{average\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Average Cycle}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Y axis settings}
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{100.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{50}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} X axis settings}
         \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{index}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{20.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{20}
         
         \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{l+m+mi}{20}
         \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{)}
         \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{x\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Months\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Legend settings}
         \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.15}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Display}
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{cuxe1lculo-de-los-coeficientes-de-regresiuxf3n}{%
\subsubsection{Cálculo de los coeficientes de
regresión}\label{cuxe1lculo-de-los-coeficientes-de-regresiuxf3n}}

    Los coeficientes de regresion se calculan mediante la fromula

    \[
\mathcal{k}_{n} = \frac{\displaystyle\sum_{c=m}^{M} \Delta\mathcal{R}_{n,c}\Delta\mathcal{R}_{n+1,c}}{\displaystyle\sum_{c=m}^{M} \Delta\mathcal{R}_{n,c}^{2}}
\]

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{k}{def} \PY{n+nf}{usum}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{n}{xshape} \PY{o}{=} \PY{n}{x}\PY{o}{.}\PY{n}{shape}
             \PY{n}{xsum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{full}\PY{p}{(}\PY{n}{xshape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{xshape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{row} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{p}{:}\PY{p}{]}
                 \PY{n}{test} \PY{o}{=} \PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{row}\PY{p}{)}
                 
                 \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                     \PY{n}{xsum}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
                     
                 \PY{k}{elif} \PY{n+nb}{any}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                     \PY{n}{xsum}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{isfinite}\PY{p}{(}\PY{n}{test}\PY{p}{)}\PY{p}{]}\PY{p}{)}
                     
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{xsum}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{row}\PY{p}{)}
                     
             \PY{k}{return} \PY{n}{xsum}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{k}{def} \PY{n+nf}{regression\PYZus{}coefficients}\PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{p}{,} \PY{n}{average\PYZus{}cycle}\PY{p}{)}\PY{p}{:}
             \PY{n}{numerator} \PY{o}{=} \PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{average\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
             \PY{n}{shape} \PY{o}{=} \PY{n}{numerator}\PY{o}{.}\PY{n}{shape}
             \PY{n}{numerator} \PY{o}{=} \PY{n}{numerator}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
             \PY{n}{numerator}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{)}
             \PY{n}{numerator} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{numerator}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{numerator} \PY{o}{=} \PY{n}{numerator}\PY{p}{[}\PY{p}{:}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{n}{numerator}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{]}
             \PY{n}{numerator} \PY{o}{=} \PY{n}{usum}\PY{p}{(}\PY{n}{numerator}\PY{p}{)}
         
             \PY{n}{denominator} \PY{o}{=} \PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{average\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
             \PY{n}{denominator} \PY{o}{=} \PY{n}{denominator}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}
             \PY{n}{denominator} \PY{o}{=} \PY{n}{usum}\PY{p}{(}\PY{n}{denominator}\PY{p}{)}
         
             \PY{n}{coeffs} \PY{o}{=} \PY{n}{numerator}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{p}{(}\PY{n}{denominator}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{coeffs} \PY{o}{=} \PY{n}{coeffs}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
             \PY{n}{coeffs} \PY{o}{+}\PY{o}{=} \PY{p}{[}\PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{]}
             \PY{n}{coeffs} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{coeffs}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{K}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{k}{return} \PY{n}{coeffs}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{coeffs} \PY{o}{=} \PY{n}{regression\PYZus{}coefficients}\PY{p}{(}\PY{n}{selected\PYZus{}cycles}\PY{p}{,} \PY{n}{average\PYZus{}cycle}\PY{p}{)}
         \PY{n}{coeffs}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}37}]:}                    K
         0    1.0311+/-0.0034
         1    1.0039+/-0.0033
         2    0.9621+/-0.0033
         3      0.966+/-0.004
         4      1.019+/-0.005
         5      1.088+/-0.004
         6    1.0307+/-0.0033
         7      1.036+/-0.004
         8      1.097+/-0.004
         9    1.1114+/-0.0035
         10   1.0869+/-0.0031
         11   1.0718+/-0.0028
         12   1.0995+/-0.0030
         13   1.1187+/-0.0028
         14   1.0821+/-0.0026
         15   1.0703+/-0.0025
         16   1.1070+/-0.0025
         17   1.1043+/-0.0022
         18   1.0911+/-0.0021
         19   1.0910+/-0.0018
         20   1.1024+/-0.0018
         21   1.1055+/-0.0017
         22   1.1084+/-0.0016
         23   1.0917+/-0.0014
         24   1.0508+/-0.0013
         25   1.0660+/-0.0013
         26   1.0885+/-0.0012
         27   1.0515+/-0.0011
         28   1.0249+/-0.0010
         29   1.0361+/-0.0010
         ..               {\ldots}
         121  0.8417+/-0.0022
         122  0.9264+/-0.0022
         123  0.9591+/-0.0023
         124  0.9259+/-0.0027
         125  0.8539+/-0.0030
         126  0.8869+/-0.0028
         127  0.9067+/-0.0032
         128  0.9246+/-0.0034
         129    0.948+/-0.004
         130    1.012+/-0.004
         131  1.0184+/-0.0032
         132  1.0081+/-0.0029
         133  1.0061+/-0.0030
         134  0.9109+/-0.0035
         135  0.8907+/-0.0028
         136    0.837+/-0.005
         137    0.759+/-0.005
         138    0.888+/-0.004
         139    0.871+/-0.004
         140    0.750+/-0.009
         141    0.624+/-0.010
         142    0.730+/-0.008
         143    0.706+/-0.010
         144    0.855+/-0.012
         145    0.806+/-0.014
         146    0.776+/-0.017
         147    1.040+/-0.020
         148         -0.0+/-0
         149          0.0+/-0
         150          0.0+/-0
         
         [151 rows x 1 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{coeffs}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_90_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{prediccion-de-la-actividad-solar}{%
\subsubsection{Prediccion de la actividad
solar}\label{prediccion-de-la-actividad-solar}}

    Una vez obtenidos los coeficientes de regresión, la predicción se
realiza mendiante la fórmula

    \[
\mathcal{R'}_{n+1} = \tilde{\mathcal{R}}_{n+1} + \mathcal{k}_{n}\Delta\mathcal{R}_{n}
\]

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{cycle\PYZus{}prediction} \PY{o}{=} \PY{n}{current\PYZus{}cycle}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{cycle\PYZus{}prediction} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{cycle\PYZus{}prediction}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{average\PYZus{}deviation} \PY{o}{=} \PY{n}{cycle\PYZus{}prediction} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{average\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{average\PYZus{}deviation} \PY{o}{=} \PY{n}{average\PYZus{}deviation}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{coeffs}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{start}\PY{p}{,} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{isnan}\PY{p}{(}\PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{current\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{start} \PY{o}{=} \PY{n}{start}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{offset} \PY{o}{=} \PY{l+m+mi}{20}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{start}\PY{p}{,} \PY{n}{start}\PY{o}{+}\PY{n}{offset}\PY{p}{)}\PY{p}{:}
                 \PY{n}{cycle\PYZus{}prediction}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{average\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{average\PYZus{}deviation}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
                 \PY{n}{average\PYZus{}deviation}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{cycle\PYZus{}prediction}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{average\PYZus{}cycle}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                 \PY{n}{average\PYZus{}deviation}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{average\PYZus{}deviation}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{coeffs}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{[}\PY{n}{i}\PY{p}{]}
                 
         \PY{n}{cycle\PYZus{}prediction}\PY{p}{[}\PY{p}{:}\PY{n}{start}\PY{p}{]} \PY{o}{=} \PY{n}{unc}\PY{o}{.}\PY{n}{ufloat}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{)}
\end{Verbatim}


    \hypertarget{comparaciuxf3n-de-los-resultados-obtenidos}{%
\subsubsection{Comparación de los resultados
obtenidos}\label{comparaciuxf3n-de-los-resultados-obtenidos}}

    \hypertarget{resultados-obtenidos}{%
\paragraph{Resultados obtenidos}\label{resultados-obtenidos}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{scale\PYZus{}std} \PY{o}{=} \PY{l+m+mi}{25}
         
         \PY{n}{softb\PYZus{}t} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{date\PYZus{}range}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1/1/2030}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{softb\PYZus{}t} \PY{o}{=} \PY{n}{softb\PYZus{}t}\PY{p}{[}\PY{n}{softb\PYZus{}t}\PY{o}{.}\PY{n}{day}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{softb\PYZus{}t} \PY{o}{=} \PY{n}{softb\PYZus{}t}\PY{p}{[}\PY{n}{start}\PY{p}{:}\PY{n}{start}\PY{o}{+}\PY{n}{offset}\PY{p}{]}
         
         \PY{n}{softb\PYZus{}d} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}
             \PY{n+nb}{zip}\PY{p}{(}
                 \PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{cycle\PYZus{}prediction}\PY{p}{)}\PY{p}{[}\PY{n}{start}\PY{p}{:}\PY{n}{start}\PY{o}{+}\PY{n}{offset}\PY{p}{]}\PY{p}{,} 
                 \PY{p}{(}\PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{cycle\PYZus{}prediction}\PY{p}{)}\PY{o}{+}\PY{n}{scale\PYZus{}std}\PY{o}{*}\PY{n}{unp}\PY{o}{.}\PY{n}{std\PYZus{}devs}\PY{p}{(}\PY{n}{cycle\PYZus{}prediction}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{n}{start}\PY{p}{:}\PY{n}{start}\PY{o}{+}\PY{n}{offset}\PY{p}{]}\PY{p}{,}
                 \PY{p}{(}\PY{n}{unp}\PY{o}{.}\PY{n}{nominal\PYZus{}values}\PY{p}{(}\PY{n}{cycle\PYZus{}prediction}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{scale\PYZus{}std}\PY{o}{*}\PY{n}{unp}\PY{o}{.}\PY{n}{std\PYZus{}devs}\PY{p}{(}\PY{n}{cycle\PYZus{}prediction}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{n}{start}\PY{p}{:}\PY{n}{start}\PY{o}{+}\PY{n}{offset}\PY{p}{]}\PY{p}{,}
             \PY{p}{)}
         \PY{p}{)}
         
         \PY{n}{softb} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{softb\PYZus{}d}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{softb\PYZus{}t}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{softb}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}40}]:}              Forecast        Max        Min
         2018-05-01   7.585896   9.333494   5.838298
         2018-06-01   6.962493   8.975697   4.949289
         2018-07-01   5.826022   8.102780   3.549265
         2018-08-01   7.201578   9.702553   4.700604
         2018-09-01   6.657180   9.272926   4.041433
         2018-10-01   6.018379   8.719644   3.317114
         2018-11-01   5.339004   8.090317   2.587691
         2018-12-01   4.871735   7.634539   2.108931
         2019-01-01   8.691469  11.408112   5.974825
         2019-02-01  11.546243  14.291436   8.801050
         2019-03-01  11.650268  14.368677   8.931858
         2019-04-01  11.275086  13.955203   8.594968
         2019-05-01  11.794482  14.408522   9.180442
         2019-06-01  13.519937  16.154324  10.885551
         2019-07-01  12.800834  15.298950  10.302718
         2019-08-01  11.716092  14.100243   9.331941
         2019-09-01  10.608154  12.880465   8.335844
         2019-10-01   9.740125  11.930991   7.549259
         2019-11-01   8.987699  11.140204   6.835195
         2019-12-01   8.189856  10.280116   6.099595
\end{Verbatim}
            
    \hypertarget{predicciuxf3n-de-noaa}{%
\paragraph{Predicción de NOAA}\label{predicciuxf3n-de-noaa}}

    Estos datos fueron obtenidos directamente del servicio FTP de NOAA

\begin{itemize}
\tightlist
\item
  ftp://ftp.swpc.noaa.gov/pub/weekly/Predict.txt
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{noaa\PYZus{}t} \PY{o}{=} \PY{p}{[}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}05\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}06\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}07\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}08\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}09\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}10\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}11\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}12\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}02\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}03\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}04\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}05\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}06\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}07\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}08\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}09\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}10\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}11\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}12\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} 
         \PY{p}{]}
         
         \PY{n}{noaa\PYZus{}d} \PY{o}{=} \PY{p}{[}
             \PY{p}{[}\PY{l+m+mf}{4.8}\PY{p}{,}  \PY{l+m+mf}{5.8}\PY{p}{,} \PY{l+m+mf}{3.8}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{5.3}\PY{p}{,}  \PY{l+m+mf}{7.3}\PY{p}{,} \PY{l+m+mf}{3.3}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{5.6}\PY{p}{,}  \PY{l+m+mf}{8.6}\PY{p}{,} \PY{l+m+mf}{2.6}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{5.9}\PY{p}{,} \PY{l+m+mf}{10.9}\PY{p}{,} \PY{l+m+mf}{0.9}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.3}\PY{p}{,} \PY{l+m+mf}{11.3}\PY{p}{,} \PY{l+m+mf}{1.3}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.6}\PY{p}{,} \PY{l+m+mf}{12.6}\PY{p}{,} \PY{l+m+mf}{0.6}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.7}\PY{p}{,} \PY{l+m+mf}{13.7}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.5}\PY{p}{,} \PY{l+m+mf}{13.5}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.6}\PY{p}{,} \PY{l+m+mf}{14.6}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.8}\PY{p}{,} \PY{l+m+mf}{15.8}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.9}\PY{p}{,} \PY{l+m+mf}{15.9}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{7.1}\PY{p}{,} \PY{l+m+mf}{17.1}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{7.0}\PY{p}{,} \PY{l+m+mf}{17.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{6.4}\PY{p}{,} \PY{l+m+mf}{16.4}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{5.9}\PY{p}{,} \PY{l+m+mf}{15.9}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{5.5}\PY{p}{,} \PY{l+m+mf}{15.5}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{5.1}\PY{p}{,} \PY{l+m+mf}{15.1}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{4.8}\PY{p}{,} \PY{l+m+mf}{14.8}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{4.4}\PY{p}{,} \PY{l+m+mf}{14.4}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{4.1}\PY{p}{,} \PY{l+m+mf}{14.1}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{,}   
         \PY{p}{]}
         \PY{n}{noaa} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{noaa\PYZus{}d}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{noaa\PYZus{}t}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{noaa}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}41}]:}             Forecast   Max  Min
         2018-05-01       4.8   5.8  3.8
         2018-06-01       5.3   7.3  3.3
         2018-07-01       5.6   8.6  2.6
         2018-08-01       5.9  10.9  0.9
         2018-09-01       6.3  11.3  1.3
         2018-10-01       6.6  12.6  0.6
         2018-11-01       6.7  13.7  0.0
         2018-12-01       6.5  13.5  0.0
         2019-01-01       6.6  14.6  0.0
         2019-02-01       6.8  15.8  0.0
         2019-03-01       6.9  15.9  0.0
         2019-04-01       7.1  17.1  0.0
         2019-05-01       7.0  17.0  0.0
         2019-06-01       6.4  16.4  0.0
         2019-07-01       5.9  15.9  0.0
         2019-08-01       5.5  15.5  0.0
         2019-09-01       5.1  15.1  0.0
         2019-10-01       4.8  14.8  0.0
         2019-11-01       4.4  14.4  0.0
         2019-12-01       4.1  14.1  0.0
\end{Verbatim}
            
    \hypertarget{predicciuxf3n-de-silso}{%
\paragraph{Predicción de SILSO}\label{predicciuxf3n-de-silso}}

    Estos datos fueron obtenidos directamente del servicio web de SILSO

\begin{itemize}
\tightlist
\item
  http://sidc.oma.be/silso/FORECASTS/prediML.txt
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{silso\PYZus{}t} \PY{o}{=} \PY{p}{[}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}05\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}06\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}07\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}08\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}09\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}10\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}11\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2018\PYZhy{}12\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}02\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}03\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}04\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}05\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}06\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}07\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}08\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}09\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
             \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{2019\PYZhy{}10\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}   
         \PY{p}{]}
         
         \PY{n}{silso\PYZus{}d} \PY{o}{=} \PY{p}{[}
             \PY{p}{[} \PY{l+m+mf}{7.3}\PY{p}{,}   \PY{l+m+mf}{2.5}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{6.4}\PY{p}{,}   \PY{l+m+mf}{4.8}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{5.2}\PY{p}{,}   \PY{l+m+mf}{6.3}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{4.8}\PY{p}{,}   \PY{l+m+mf}{7.5}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{4.7}\PY{p}{,}   \PY{l+m+mf}{8.1}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{4.5}\PY{p}{,}   \PY{l+m+mf}{8.5}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{4.2}\PY{p}{,}   \PY{l+m+mf}{9.1}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{4.2}\PY{p}{,}  \PY{l+m+mf}{10.0}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{4.3}\PY{p}{,}  \PY{l+m+mf}{10.8}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{4.9}\PY{p}{,}  \PY{l+m+mf}{11.4}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{5.8}\PY{p}{,}  \PY{l+m+mf}{11.1}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{6.2}\PY{p}{,}  \PY{l+m+mf}{10.5}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{6.7}\PY{p}{,}  \PY{l+m+mf}{10.3}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{8.0}\PY{p}{,}  \PY{l+m+mf}{10.4}\PY{p}{]}\PY{p}{,}
             \PY{p}{[} \PY{l+m+mf}{9.7}\PY{p}{,}  \PY{l+m+mf}{10.8}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{10.9}\PY{p}{,}  \PY{l+m+mf}{12.2}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{12.3}\PY{p}{,}  \PY{l+m+mf}{14.3}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{l+m+mf}{14.0}\PY{p}{,}  \PY{l+m+mf}{16.7}\PY{p}{]}\PY{p}{,}
         \PY{p}{]}
         \PY{n}{silso\PYZus{}d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{silso\PYZus{}d}\PY{p}{)}
         \PY{n}{silso\PYZus{}d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{silso\PYZus{}d}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{silso\PYZus{}d}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{silso\PYZus{}d}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{silso\PYZus{}d}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{silso\PYZus{}d}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{silso} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{silso\PYZus{}d}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{silso\PYZus{}t}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{silso}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:}             Forecast   Max  Min
         2018-05-01       7.3   9.8  4.8
         2018-06-01       6.4  11.2  1.6
         2018-07-01       5.2  11.5 -1.1
         2018-08-01       4.8  12.3 -2.7
         2018-09-01       4.7  12.8 -3.4
         2018-10-01       4.5  13.0 -4.0
         2018-11-01       4.2  13.3 -4.9
         2018-12-01       4.2  14.2 -5.8
         2019-01-01       4.3  15.1 -6.5
         2019-02-01       4.9  16.3 -6.5
         2019-03-01       5.8  16.9 -5.3
         2019-04-01       6.2  16.7 -4.3
         2019-05-01       6.7  17.0 -3.6
         2019-06-01       8.0  18.4 -2.4
         2019-07-01       9.7  20.5 -1.1
         2019-08-01      10.9  23.1 -1.3
         2019-09-01      12.3  26.6 -2.0
         2019-10-01      14.0  30.7 -2.7
\end{Verbatim}
            
    \hypertarget{comparaciuxf3n-de-resultados}{%
\paragraph{Comparación de
resultados}\label{comparaciuxf3n-de-resultados}}

    \hypertarget{comparacion-con-los-resultados-de-noaa}{%
\subparagraph{\texorpdfstring{\textbf{Comparacion con los resultados de
NOAA}}{Comparacion con los resultados de NOAA}}\label{comparacion-con-los-resultados-de-noaa}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{index} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}
         
         \PY{c+c1}{\PYZsh{} Resultados}
         \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Smoot}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{softb}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}aa00ff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{fill\PYZus{}between}\PY{p}{(}
             \PY{n}{softb}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}e1bee7}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Error\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Y axis settings}
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{25.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{25}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{25}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} X axis settings}
         \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{softb.index[\PYZhy{}1].year+1\PYZcb{}\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{)}
         \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Date\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Legend and title settings}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{]}\PY{p}{)}  
         \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Resultados NOAA}
         \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Current}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ cycle\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
             
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{noaa}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{noaa}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}aa00ff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{fill\PYZus{}between}\PY{p}{(}
             \PY{n}{noaa}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{noaa}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{noaa}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}e1bee7}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Error\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Y axis settings}
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{25.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{25}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{25}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} X axis settings}
         \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{softb.index[\PYZhy{}1].year+1\PYZcb{}\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{)}
         \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Date\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Legend and title settings}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{NOAA}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Forecast\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{]}\PY{p}{)}  
         \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Comparacion}
         \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Smoot}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{softb}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}aa00ff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{noaa}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{noaa}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}1de9b6}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{NOAA}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Forecast\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Y axis settings}
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{25.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{25}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{25}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} X axis settings}
         \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{softb.index[\PYZhy{}1].year+1\PYZcb{}\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{)}
         \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Date\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Legend and title settings}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Comparsion\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.10}\PY{p}{]}\PY{p}{)}  
         \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.10}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Display}
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{comparacion-con-los-resultados-de-silso}{%
\subparagraph{\texorpdfstring{\textbf{Comparacion con los resultados de
SILSO}}{Comparacion con los resultados de SILSO}}\label{comparacion-con-los-resultados-de-silso}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{frameon}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}ffffff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{index} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}
         
         \PY{c+c1}{\PYZsh{} Resultados}
         \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Smoot}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{softb}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}aa00ff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{fill\PYZus{}between}\PY{p}{(}
             \PY{n}{softb}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}e1bee7}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Error\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Y axis settings}
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{25.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{25}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{25}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} X axis settings}
         \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{softb.index[\PYZhy{}1].year+1\PYZcb{}\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{)}
         \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Date\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Legend and title settings}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{]}\PY{p}{)}  
         \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Resultados SILSO}
         \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Current}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ cycle\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
             
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{silso}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{silso}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}aa00ff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{fill\PYZus{}between}\PY{p}{(}
             \PY{n}{silso}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{silso}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{silso}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Max}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{facecolor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}e1bee7}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Error\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Y axis settings}
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{25.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{25}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{25}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} X axis settings}
         \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{softb.index[\PYZhy{}1].year+1\PYZcb{}\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{)}
         \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Date\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Legend and title settings}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{SILSO}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Forecast\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{]}\PY{p}{)}  
         \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.16}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Comparacion}
         \PY{n}{axs} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{Smoot}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Monthly}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ mean\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{softb}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{softb}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}aa00ff}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Forecast\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{plot}\PY{p}{(}
             \PY{n}{silso}\PY{o}{.}\PY{n}{index}\PY{p}{,}
             \PY{n}{silso}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Forecast}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} 
             \PY{n}{color}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}1de9b6}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
             \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{antialiased}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
             \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{SILSO}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{ Forecast\PYZcb{}\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Y axis settings}
         \PY{n}{y\PYZus{}liml} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{y\PYZus{}limu} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{sn\PYZus{}monthly}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SN value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)} \PY{o}{/} \PY{l+m+mf}{25.0}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{25}
         
         \PY{n}{d\PYZus{}yticks} \PY{o}{=} \PY{l+m+mi}{25}
         \PY{n}{n\PYZus{}yticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}limu} \PY{o}{\PYZhy{}} \PY{n}{y\PYZus{}liml}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}yticks}\PY{p}{)}
         \PY{n}{t\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{n}{y\PYZus{}liml} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}yticks} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}yticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}yticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}0:\PYZgt{}3\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{t\PYZus{}yticks}\PY{p}{]}
         
         \PY{n}{y\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}ISN\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{n}{y\PYZus{}liml}\PY{p}{,} \PY{n}{y\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{n}{t\PYZus{}yticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{l\PYZus{}yticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{y\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} X axis settings}
         \PY{n}{x\PYZus{}liml} \PY{o}{=} \PY{n}{lcycles}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cycle 24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{x\PYZus{}limu} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{softb.index[\PYZhy{}1].year+1\PYZcb{}\PYZhy{}01\PYZhy{}01}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{d\PYZus{}xticks} \PY{o}{=} \PY{l+m+mi}{2}
         \PY{n}{n\PYZus{}xticks} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ceil}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}limu}\PY{o}{.}\PY{n}{year} \PY{o}{\PYZhy{}} \PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{o}{/} \PY{n}{d\PYZus{}xticks}\PY{p}{)}\PY{p}{)}
         \PY{n}{t\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Timestamp}\PY{p}{(}\PY{n}{x\PYZus{}liml}\PY{o}{.}\PY{n}{year} \PY{o}{+} \PY{n}{i} \PY{o}{*} \PY{n}{d\PYZus{}xticks}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}xticks} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         \PY{n}{l\PYZus{}xticks} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+si}{\PYZob{}1:\PYZgt{}4\PYZcb{}}\PY{l+s+s2}{\PYZdl{}\PYZhy{}\PYZdl{}}\PY{l+s+si}{\PYZob{}0:0\PYZgt{}2\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{month}\PY{p}{,} \PY{n}{x}\PY{o}{.}\PY{n}{year}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{t\PYZus{}xticks}\PY{p}{]}
         
         \PY{n}{x\PYZus{}label} \PY{o}{=} \PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Date\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}liml}\PY{p}{,} \PY{n}{x\PYZus{}limu}\PY{p}{]}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{t\PYZus{}xticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{l\PYZus{}xticks}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}ticks}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{n}{x\PYZus{}label}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}label}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Legend and title settings}
         \PY{n}{axs}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{mathrm}\PY{l+s+si}{\PYZob{}Comparsion\PYZcb{}}\PY{l+s+s2}{\PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontproperties}\PY{o}{=}\PY{n}{font\PYZus{}title}\PY{p}{)}
         \PY{n}{axs}\PY{o}{.}\PY{n}{title}\PY{o}{.}\PY{n}{set\PYZus{}position}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.10}\PY{p}{]}\PY{p}{)}  
         \PY{n}{axs}\PY{o}{.}\PY{n}{legend}\PY{p}{(}
             \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mf}{1.10}\PY{p}{)}\PY{p}{,}
             \PY{n}{ncol}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,}
             \PY{n}{borderaxespad}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,}
             \PY{n}{prop}\PY{o}{=}\PY{n}{font\PYZus{}legend}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Display}
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_108_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
